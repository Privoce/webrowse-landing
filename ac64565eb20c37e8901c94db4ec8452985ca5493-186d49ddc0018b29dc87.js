"use strict";(self.webpackChunkwebrowse_landing=self.webpackChunkwebrowse_landing||[]).push([[1514,3615,3754,299],{7289:function(e,t,n){n.r(t),n.d(t,{default:function(){return b}});var r=n(5861),a=n(4687),o=n.n(a),i=n(7294),c=n(6963),u=n.n(c),l="733ebd8906c84f8baafcbf548dcfe7da";var s,d=n(8278),f=n(8570),p=n(1367),m=n(77),v=n(9390),h=n(1720),E=null===u()||void 0===u()||null===(s=u().createClient)||void 0===s?void 0:s.call(u(),{codec:"h264",mode:"rtc"}),b=function(){var e=(0,i.useContext)(m.VoiceContext),t=e.dispatch,n=e.state,a=n||{},c=a.status,s=a.cameraId,b=a.microphoneId,x=a.currentUser,g=a.users,w=new URLSearchParams("undefined"!=typeof window?window.location.search:""),y=(null==x?void 0:x.intUid)||function(){for(var e="123456789",t=e.length,n=[],r=0;r<9;r++)n[r]=e.charAt(Math.random()*t);return+n.join("")}()||+w.get("uid")||1,k=w.get("cid")||"test",N=function(e){var t=(0,i.useState)(void 0),n=t[0],a=t[1],c=(0,i.useState)(void 0),s=c[0],d=c[1],f=(0,i.useState)([]),p=f[0],m=f[1],v=(0,i.useState)(""),h=v[0],E=v[1],b=(0,i.useState)(null),x=b[0],g=b[1],w=(0,i.useState)(!1),y=w[0],k=w[1],N=(0,i.useState)([]),T=N[0],A=N[1],U=(0,i.useState)([]),_=U[0],C=U[1],S=function(){var e=(0,r.Z)(o().mark((function e(t,n){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://wechat.okeydemo.com/api/agora/get_token?uid="+t+"&channel="+n);case 2:return r=e.sent,e.next=5,r.text();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();function j(e,t){return I.apply(this,arguments)}function I(){return(I=(0,r.Z)(o().mark((function e(t,n){var r,i,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u().createMicrophoneAndCameraTracks(t,n);case 2:return r=e.sent,i=r[0],c=r[1],d(i),a(c),e.abrupt("return",[i,c]);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(0,i.useEffect)((function(){e&&(0,r.Z)(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u().getDevices();case 2:t=e.sent,m(t);case 4:case"end":return e.stop()}}),e)})))()}),[e]);var V=(0,i.useCallback)(function(){var t=(0,r.Z)(o().mark((function t(n,r,a,i){var c,u,s,d;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e&&r){t.next=2;break}return t.abrupt("return");case 2:return e.enableAudioVolumeIndicator(),g(r),E(n),t.next=7,S(r,n);case 7:return c=t.sent,t.next=10,j(a,i);case 10:return u=t.sent,s=u[0],d=u[1],t.next=15,e.join(l,n,c||null,+r);case 15:return t.next=17,e.publish([s,d]);case 17:window.client=e,window.videoTrack=d,k(!0);case 20:case"end":return t.stop()}}),t)})));return function(e,n,r,a){return t.apply(this,arguments)}}(),[]);function D(){return(D=(0,r.Z)(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s&&(s.stop(),s.close()),n&&(n.stop(),n.close()),A([]),k(!1),t.next=6,null==e?void 0:e.leave();case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return(0,i.useEffect)((function(){if(e){A(e.remoteUsers);var t=function(){var t=(0,r.Z)(o().mark((function t(n,r){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.subscribe(n,r);case 2:A((function(t){return Array.from(e.remoteUsers)}));case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),n=function(t){A((function(t){return Array.from(e.remoteUsers)}))},a=function(t){A((function(t){return Array.from(e.remoteUsers)}))},i=function(t){A((function(t){return Array.from(e.remoteUsers)}))};return e.on("user-published",t),e.on("user-unpublished",n),e.on("user-joined",a),e.on("user-left",i),function(){e.off("user-published",t),e.off("user-unpublished",n),e.off("user-joined",a),e.off("user-left",i)}}}),[e]),(0,i.useEffect)((function(){if(e&&h&&x){var t=function(){var t=(0,r.Z)(o().mark((function t(){var n;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("WillExpire"),t.next=3,S(x,h);case 3:return n=t.sent,t.next=6,e.renewToken(n);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),n=function(){var t=(0,r.Z)(o().mark((function t(){var n;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("Fetching the new Token"),t.next=3,S(x,h);case 3:return n=t.sent,console.log("Rejoining the channel with new Token"),t.next=7,e.join(l,h,n,x);case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),a=function(e){C(e),e.forEach((function(e,t){console.log(t+" UID "+e.uid+" Level "+e.level)}))};return e.on("token-privilege-will-expire",t),e.on("token-privilege-did-expire",n),e.on("volume-indicator",a),function(){e.off("token-privilege-will-expire",t),e.off("token-privilege-did-expire",n),e.off("volume-indicator",a)}}}),[e,h,x]),{localAudioTrack:s,localVideoTrack:n,joinState:y,leave:function(){return D.apply(this,arguments)},join:V,remoteUsers:T,devices:p,volumes:_}}(E),T=N.localAudioTrack,A=N.localVideoTrack,U=N.join,_=N.joinState,C=N.remoteUsers;(0,i.useEffect)((function(){t({type:m.UPDATE_CLIENT,payload:E})}),[]),(0,i.useEffect)((function(){}),[y,k]),(0,i.useEffect)((function(){A&&T&&(t({type:m.UPDATE_LOCAL_VIDEO_TRACK,payload:A}),t({type:m.UPDATE_LOCAL_AUDIO_TRACK,payload:T}))}),[A,T]),(0,i.useEffect)((function(){t({type:m.UPDATE_JOIN_STATE,payload:_})}),[_]),(0,i.useEffect)((function(){var e,t={source:"webrow.se/voice",payload:{status:null==n?void 0:n.status},event:"connect"};null===(e=window)||void 0===e||e.postMessage(t,"*")}),[null==n?void 0:n.status]),(0,i.useEffect)((function(){(0,r.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("will-join"!==(null==n?void 0:n.status)){e.next=3;break}return e.next=3,S({microphoneId:b},{cameraId:s});case 3:case"end":return e.stop()}}),e)})))()}),[null==n?void 0:n.status,s,b]),(0,i.useEffect)((function(){t({type:m.UPDATE_USERS,payload:C})}),[C]),(0,i.useEffect)((function(){var e,t=g.map((function(e){return{uid:e.uid,hasVideo:e.hasVideo,hasAudio:e.hasAudio,current:!1}}));null!=n&&n.joinState&&t.unshift({uid:null==x?void 0:x.intUid,hasVideo:null==n?void 0:n.videoEnabled,hasAudio:null==n?void 0:n.audioEnabled,current:!0});var r={source:"webrow.se/voice",payload:{remoteUsers:t},event:"remote_users"};null===(e=window)||void 0===e||e.postMessage(r,"*")}),[g,null==x?void 0:x.intUid,null==n?void 0:n.joinState,null==n?void 0:n.videoEnabled,null==n?void 0:n.audioEnabled]);var S=function(){var e=(0,r.Z)(o().mark((function e(n,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:m.UPDATE_STATUS,payload:"connecting"}),e.next=3,U(k,y,n,r);case 3:t({type:m.UPDATE_JOIN_STATE,payload:!0}),t({type:m.UPDATE_STATUS,payload:"connected"});case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return i.createElement(f.default,null,i.createElement("header",{className:"header"},i.createElement("h1",{className:"title"},i.createElement("img",{className:"logo",src:h.Z,alt:""})),i.createElement("h2",{className:"sub_title"},"Sync tabs with your teammates!")),null!=n&&n.joinState?i.createElement(i.Fragment,null,i.createElement(p.default,null),i.createElement(d.default,null)):i.createElement("div",{className:"joinWrap"},i.createElement("button",{disabled:"connecting"===c,className:"button",onClick:function(){return S({microphoneId:b},{cameraId:s})}},i.createElement("div",{className:"inner"},i.createElement(v.JoinRoom,null)),"connecting"===c?"connecting":"Join")))}},7112:function(e,t,n){n.r(t);var r=n(7294),a=n(535),o=n(77),i=n(9390),c=a.default.div.withConfig({displayName:"Buttons__StyledWrap",componentId:"sc-t5bzkq-0"})([".buttonMain{}.button{border:none;background:none;cursor:pointer;&:disabled{opacity:0.3;}&Icon{width:48px;height:48px;background-color:#f26b4d;border-radius:12px;display:flex;align-items:center;justify-content:center;&:hover{background-color:#c35037;}}.text{color:#fff;font-size:14px;margin-top:10px;text-align:center;}&Inner{}}"]);t.default=function(){var e=(0,r.useContext)(o.VoiceContext)||{},t=e.state,n=e.dispatch,a=t||{},u=a.localVideoTrack,l=a.localAudioTrack,s=a.videoEnabled,d=a.audioEnabled,f=a.joinState,p=function(e){void 0===e&&(e="video");var t="video"===e?s:d;n({type:o.UPDATE_DEVICES_ENABLED,payload:{devices:e,enabled:!t}})};return(0,r.useEffect)((function(){null==u||u.setMuted(!s)}),[s]),(0,r.useEffect)((function(){null==l||l.setMuted(!d)}),[d]),r.createElement(c,null,r.createElement("button",{onClick:function(){return p()},className:"button"},r.createElement("div",{className:"buttonInner"},r.createElement("div",{className:"buttonIcon"},s?r.createElement(i.Video,null):r.createElement(i.VideoClose,null)),r.createElement("div",{className:"text"},"Cam"))),r.createElement("button",{onClick:function(){return p("audio")},className:"button"},r.createElement("div",{className:"buttonInner"},r.createElement("div",{className:"buttonIcon"},d?r.createElement(i.Audio,null):r.createElement(i.AudioClose,null)),r.createElement("div",{className:"text"},"Mic"))),r.createElement("button",{disabled:!f,onClick:function(){n({type:o.LEAVE})},className:"button"},r.createElement("div",{className:"buttonInner"},r.createElement("div",{className:"buttonIcon"},r.createElement(i.Exit,null)),r.createElement("div",{className:"text"},"Leave"))))}},8278:function(e,t,n){n.r(t);var r=n(7294),a=n(8599),o=n(7112);t.default=function(){return r.createElement(a.default,null,r.createElement(o.default,null))}},8599:function(e,t,n){n.r(t);var r=n(535).default.footer.withConfig({displayName:"styles__StyledWrapper",componentId:"sc-19oqb2v-0"})(["display:flex;align-items:center;justify-content:center;margin-bottom:10px;"]);t.default=r},1367:function(e,t,n){n.r(t);var r=n(7294),a=n(9965),o=n(881),i=n(77);t.default=function(){var e=(0,r.useContext)(i.VoiceContext).state,t=void 0===e?{}:e,n=t.localVideoTrack,c=t.users,u=t.currentUser,l=t.extUsers;return r.createElement(a.default,null,r.createElement("ul",{className:"users "+((null==c?void 0:c.length)>1?"usersMore":"")},r.createElement("li",{className:"user"},r.createElement(o.default,{videoTrack:n,audioTrack:void 0}),(null==n?void 0:n.muted)&&r.createElement("div",{className:"info"},null!=u&&u.photo?r.createElement("div",{className:"avatar"},r.createElement("img",{src:null==u?void 0:u.photo,className:"pic",alt:""})):r.createElement("div",{className:"name"},null==u?void 0:u.username))),null==c?void 0:c.map((function(e){var t,n,a;return r.createElement("li",{key:e.uid,className:"user"},r.createElement(o.default,{videoTrack:e.videoTrack,audioTrack:e.audioTrack}),!e.hasVideo&&r.createElement("div",{className:"info"},null!==(t=l.find((function(t){return t.intUid===e.uid})))&&void 0!==t&&t.photo?r.createElement("div",{className:"avatar"},r.createElement("img",{src:null===(n=l.find((function(t){return t.intUid===e.uid})))||void 0===n?void 0:n.photo,className:"pic",alt:""})):r.createElement("div",{className:"name"},null===(a=l.find((function(t){return t.intUid===e.uid})))||void 0===a?void 0:a.username)))}))))}},9965:function(e,t,n){n.r(t);var r=n(535).default.div.withConfig({displayName:"styles__StyledWrapper",componentId:"sc-12nkcj5-0"})(["display:flex;height:100%;align-items:center;justify-content:center;.users{display:flex;flex-wrap:wrap;justify-content:center;align-items:center;gap:10px;margin-bottom:0;width:100%;&More{.player{width:320px;height:240px;}}}.user{position:relative;}.info{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);}.avatar{width:160px;height:160px;background-color:#333;overflow:hidden;.pic{width:100%;height:100%;}}.name{color:#fff;text-align:center;font-size:24px;}"]);t.default=r},8570:function(e,t,n){n.r(t);var r=n(535).default.section.withConfig({displayName:"styles__StyledWrapper",componentId:"sc-jyr8gf-0"})(["display:flex;width:100%;height:100vh;flex-direction:column;justify-content:space-between;background-color:#19181D;.header{display:flex;align-items:center;padding:15px;justify-content:center;.title{color:#056CF2;font-style:normal;font-weight:800;font-size:36px;line-height:139.8%;background-size:contain;background-repeat:no-repeat;margin-bottom:0;}.logo{width:203px;height:36px;vertical-align:middle;}.sub_title{display:none;color:#606368;font-weight:normal;font-size:24px;line-height:139.8%;margin-bottom:0;margin-left:10px;}}.joinWrap{position:absolute;z-index:1;width:100vw;height:100vh;background-color:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;color:#fff;.button{display:flex;align-items:center;cursor:pointer;border:none;background-color:#f26b4d;padding:4px 20px;border-radius:12px;gap:10px;font-size:16px;&:hover{background-color:#c35037;}}.inner{}}"]);t.default=r},1720:function(e,t,n){t.Z=n.p+"static/logo-3b78150b3a1e9627ff334233aae997b5.png"}}]);
//# sourceMappingURL=ac64565eb20c37e8901c94db4ec8452985ca5493-186d49ddc0018b29dc87.js.map