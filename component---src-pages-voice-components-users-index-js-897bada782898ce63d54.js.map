{"version":3,"file":"component---src-pages-voice-components-users-index-js-897bada782898ce63d54.js","mappings":"4KAqCA,UA1Bc,SAACA,GACb,IAAMC,GAAYC,EAAAA,EAAAA,QAAO,MAkBzB,OAjBAC,EAAAA,EAAAA,YAAU,WAAO,IAAD,EACd,GAAKF,EAAUG,QAEf,OADA,UAAAJ,EAAMK,kBAAN,SAAkBC,KAAKL,EAAUG,SAC1B,WAAO,IAAD,EACX,UAAAJ,EAAMK,kBAAN,SAAkBE,UAEnB,CAACN,EAAWD,EAAMK,cAErBF,EAAAA,EAAAA,YAAU,WACe,IAAD,EAAlBH,EAAMQ,aACR,UAAAR,EAAMQ,kBAAN,SAAkBF,QAEpB,OAAO,WAAO,IAAD,EACX,UAAAN,EAAMQ,kBAAN,SAAkBD,UAEnB,CAACP,EAAMQ,aAGR,gBAAC,UAAD,KACE,uBAAKC,IAAKR,EAAWS,UAAU,c,+BCtB/BC,E,KAAgBC,QAAAA,IAAAA,WAAH,iEAAGA,CAAH,8DAQnB,a,wEC0BA,UA/Bc,WACZ,OAAuBC,EAAAA,EAAAA,YAAWC,EAAAA,cAA1BC,MAAAA,OAAR,MAAgB,GAAhB,EACQC,EAAkDD,EAAlDC,gBAAiBC,EAAiCF,EAAjCE,MAAOC,EAA0BH,EAA1BG,YAAaC,EAAaJ,EAAbI,SAE7C,OAAO,gBAAC,UAAD,KACL,sBAAIT,UAAS,WAAWO,MAAAA,OAAA,EAAAA,EAAOG,QAAS,EAAI,YAAc,KACxD,sBAAIV,UAAU,QACZ,gBAAC,UAAD,CAAaL,WAAYW,EAAiBR,gBAAYa,IACtD,uBAAKX,UAAU,QACb,uBAAKA,UAAU,UAAS,uBAAKY,IAAKJ,MAAAA,OAAF,EAAEA,EAAaK,MAAOb,UAAU,MAAMc,IAAI,QAK5EP,MAAAA,OATJ,EASIA,EAAOQ,KAAI,SAAAC,GAAI,aACb,sBAAIC,IAAKD,EAAKE,IAAKlB,UAAU,QAE3B,gBAAC,UAAD,CAAaL,WAAYqB,EAAKrB,WAAYG,WAAYkB,EAAKlB,aAE3D,uBAAKE,UAAU,QACb,uBAAKA,UAAU,UACb,uBAAKY,IAAG,UAAEH,EAASU,MAAK,SAAAC,GAAI,OAAIA,EAAKC,SAAWL,EAAKE,cAA7C,aAAE,EAAiDL,MAAOb,UAAU,MAAMc,IAAI,e,gCCxBhGb,E,KAAgBC,QAAAA,IAAAA,WAAH,iEAAGA,CAAH,ydAgDnB,a,0mBC5CMoB,EAAY,CAChBf,MAAO,GACPgB,WAAW,EACXjB,gBAAiB,KACjBkB,gBAAiB,KACjBC,OAAQ,KACRC,OAAQ,eACRC,QAAS,GACTC,qBAAiBjB,EACjBkB,cAAc,EACdC,cAAc,EACdC,cAAUpB,EACVqB,kBAAcrB,EACdH,YAAa,GACbC,SAAU,IAGNwB,EAAe,eACfC,EAA2B,2BAC3BC,EAA2B,2BAC3BC,EAAoB,oBACpBC,EAAQ,QACRC,EAAgB,gBAChBC,EAAgB,gBAChBC,EAA0B,0BAC1BC,EAAiB,iBACjBC,EAAyB,yBACzBC,EAAoB,oBACpBC,EAAqB,qBACrBC,EAAmB,mBAEnBC,EAAU,SAACzC,EAAO0C,GAAY,IAAD,IA2B7B,EA1BIvB,EAA6CnB,EAA7CmB,gBAAiBlB,EAA4BD,EAA5BC,gBAAiBmB,EAAWpB,EAAXoB,OAC1C,OAAQsB,EAAOC,MACb,KAAKf,EACH,OAAO,OAAP,UACK5B,EADL,CAEEE,MAAOwC,EAAOE,UAGlB,KAAKf,EACH,OAAO,OAAP,UACK7B,EADL,CAEEC,gBAAiByC,EAAOE,UAE5B,KAAKd,EACH,OAAO,OAAP,UACK9B,EADL,CAEEmB,gBAAiBuB,EAAOE,UAG5B,KAAKb,EACH,OAAO,OAAP,UACK/B,EADL,CAEEkB,UAAWwB,EAAOE,UAGtB,KAAKZ,EAYH,OAXA,oBAAC,qFACKb,IACFA,EAAgB3B,OAChB2B,EAAgB0B,SAEd5C,IACFA,EAAgBT,OAChBS,EAAgB4C,SAPnB,SASOzB,MAAAA,OATP,EASOA,EAAQ0B,QATf,2CAAD,8CAWO,OAAP,UACK9C,EADL,CAEEE,MAAO,GACPgB,WAAW,EACXG,OAAQ,UAEZ,KAAKY,EACH,OAAO,OAAP,UACKjC,EADL,CAEEoB,OAAQsB,EAAOE,UAEnB,KAAKV,EACH,OAAO,OAAP,UACKlC,EADL,CAEEqB,OAAQqB,EAAOE,UAGnB,KAAKT,EACH,OAAO,OAAP,UACKnC,EADL,CAEEuB,gBAAiBmB,EAAOE,UAG5B,KAAKR,EACH,OAAO,OAAP,UACKpC,EADL,CAEEsB,QAASoB,EAAOE,UAGpB,KAAKP,EACH,MAGIK,EAAOE,QAHX,IACEtB,QAAAA,OADF,MACY,GADZ,MAEEyB,QAAAA,OAFF,WAEYzC,EAFZ,EAKA,OAAO,OAAP,UACKN,IADL,MAEMsB,EAFN,WAEyByB,EAFzB,IAKF,KAAKT,EACH,MAGII,EAAOE,QAHX,IACED,KAAAA,OADF,MACS,GADT,MAEEK,GAAAA,OAFF,WAEO1C,EAFP,EAKA,OAAO,OAAP,UACKN,IADL,MAEM2C,EAFN,MAEiBK,EAFjB,IAKF,KAAKT,EACH,OAAO,OAAP,UACKvC,EADL,CAEEG,YAAauC,EAAOE,UAGxB,KAAKJ,EACH,OAAO,OAAP,UACKxC,EADL,CAEEI,SAAUsC,EAAOE,UAErB,QACE,OAAO5C,IAIPD,GAAekD,EAAAA,EAAAA,eAAchC,GASnC,UAPwB,SAAAhC,GACtB,OAA0BiE,EAAAA,EAAAA,YAAWT,EAASxB,GAAW,SAAAkC,GAAG,OAAIA,KAAzDnD,EAAP,KAAcoD,EAAd,KACA,OAAQ,gBAACrD,EAAasD,SAAd,CAAuBC,MAAO,CAAEtD,MAAAA,EAAOoD,SAAAA,IAC5CnE,EAAMsE","sources":["webpack://webrowse-landing/./src/pages/voice/components/MediaPlayer/index.js","webpack://webrowse-landing/./src/pages/voice/components/MediaPlayer/styles.js","webpack://webrowse-landing/./src/pages/voice/components/Users/index.js","webpack://webrowse-landing/./src/pages/voice/components/Users/styles.js","webpack://webrowse-landing/./src/pages/voice/reducer.js"],"sourcesContent":["/**\n * @author: laoona\n * @date:  2022-03-01\n * @time: 14:52\n * @contact: laoona.com\n * @description: #\n */\n\nimport React, { useRef, useEffect } from \"react\"\nimport StyledWrapper from \"./styles\"\n\nconst Index = (props) => {\n  const container = useRef(null)\n  useEffect(() => {\n    if (!container.current) return\n    props.videoTrack?.play(container.current)\n    return () => {\n      props.videoTrack?.stop()\n    }\n  }, [container, props.videoTrack])\n\n  useEffect(() => {\n    if (props.audioTrack) {\n      props.audioTrack?.play()\n    }\n    return () => {\n      props.audioTrack?.stop()\n    }\n  }, [props.audioTrack])\n\n  return (\n    <StyledWrapper>\n      <div ref={container} className=\"player\" />\n    </StyledWrapper>\n  )\n}\n\nexport default Index\n","/**\n * @author: laoona\n * @date:  2022-03-18\n * @time: 22:24\n * @contact: laoona.com\n * @description: #\n */\n\nimport styled from \"styled-components\";\n\nconst StyledWrapper = styled.div`\n  .player {\n    width: 640px;\n    height: 480px;\n    background-color: #000;\n  }\n`;\n\nexport default StyledWrapper;\n","/**\n * @author: laoona\n * @date:  2022-03-18\n * @time: 17:02\n * @contact: laoona.com\n * @description: #\n */\n\nimport React, { useContext } from \"react\"\nimport StyledWrapper from \"./styles\"\nimport MediaPlayer from \"../MediaPlayer\"\nimport { VoiceContext } from \"../../reducer\"\n\nconst Users = () => {\n  const { state = {} } = useContext(VoiceContext)\n  const { localVideoTrack, users, currentUser, extUsers } = state\n\n  return <StyledWrapper>\n    <ul className={`users ${users?.length > 1 ? \"usersMore\" : \"\"}`}>\n      <li className=\"user\">\n        <MediaPlayer videoTrack={localVideoTrack} audioTrack={undefined} />\n        <div className=\"info\">\n          <div className=\"avatar\"><img src={currentUser?.photo} className=\"pic\" alt=\"\" /></div>\n          {/*<div className=\"name\">{user.username}</div>*/}\n        </div>\n      </li>\n      {\n        users?.map(user =>\n          <li key={user.uid} className=\"user\">\n            {/*(user.hasVideo || user.hasAudio) ?*/}\n            <MediaPlayer videoTrack={user.videoTrack} audioTrack={user.audioTrack} />\n            {/*:*/}\n            <div className=\"info\">\n              <div className=\"avatar\">\n                <img src={extUsers.find(item => item.intUid === user.uid)?.photo} className=\"pic\" alt=\"\" /></div>\n              {/*<div className=\"name\">{user.username}</div>*/}\n            </div>\n          </li>\n        )\n      }\n    </ul>\n  </StyledWrapper>\n}\n\nexport default Users\n","/**\n * @author: laoona\n * @date:  2022-03-18\n * @time: 17:02\n * @contact: laoona.com\n * @description: #\n */\n\nimport styled from 'styled-components';\n\nconst StyledWrapper = styled.div`\n  display: flex;\n  height: 100%;\n  align-items: center;\n  justify-content: center;\n  .users {\n    display: flex;\n    flex-wrap: wrap;\n    justify-content: center;\n    align-items: center;\n    gap: 10px;\n    margin-bottom: 0;\n    width: 100%;\n    &More {\n      .player {\n        width: 320px;\n        height: 240px;\n      } \n    }\n  }\n  .user {\n    position: relative;\n  }\n  .info {\n    position: absolute; \n    bottom: 0;\n    right: 0;\n  }\n  .avatar {\n    width: 80px;\n    height: 80px;\n    background-color: #333;\n    opacity: 0.75;\n    //border-radius: 8px;\n    overflow: hidden;\n    .pic {\n      width: 100%;\n      height: 100%;\n    }\n  }\n  .name {\n    color: #fff;\n    margin-top: 4px;\n    text-align: center;\n    font-size: 14px;\n  }\n  `;\n\nexport default StyledWrapper;\n","/**\n * @author: laoona\n * @date:  2022-03-18\n * @time: 17:37\n * @contact: laoona.com\n * @description: #\n */\n\nimport React, { createContext, useReducer } from \"react\"\n\n/**\n * status enums ['disconnected', 'will-join', 'connecting', 'connected', 'leave']\n * @type {{localAudioTrack: null, localVideoTrack: null, joinState: boolean, client: null, users: *[], status: string}}\n */\nconst initValue = {\n  users: [],\n  joinState: false,\n  localVideoTrack: null,\n  localAudioTrack: null,\n  client: null,\n  status: \"disconnected\",\n  devices: [],\n  permissionState: undefined, // enums ['dismissed', 'denied', 'allow', 'complete']\n  videoEnabled: true,\n  audioEnabled: true,\n  cameraId: undefined,\n  microphoneId: undefined,\n  currentUser: {}, // 当前扩展登录的用户\n  extUsers: [], // 当前扩展 Webrowse 用户列表\n}\n\nconst UPDATE_USERS = \"UPDATE_USERS\"\nconst UPDATE_LOCAL_VIDEO_TRACK = \"UPDATE_LOCAL_VIDEO_TRACK\"\nconst UPDATE_LOCAL_AUDIO_TRACK = \"UPDATE_LOCAL_AUDIO_TRACK\"\nconst UPDATE_JOIN_STATE = \"UPDATE_JOIN_STATE\"\nconst LEAVE = \"LEAVE\"\nconst UPDATE_CLIENT = \"UPDATE_CLIENT\"\nconst UPDATE_STATUS = \"UPDATE_STATUS\"\nconst UPDATE_PERMISSION_STATE = \"UPDATE_PERMISSION_STATE\"\nconst UPDATE_DEVICES = \"UPDATE_DEVICES\"\nconst UPDATE_DEVICES_ENABLED = \"UPDATE_DEVICES_ENABLED\"\nconst UPDATE_DEVICES_ID = \"UPDATE_DEVICES_ID\"\nconst UPDATE_CURRENT_USR = \"UPDATE_CURRENT_USR\"\nconst UPDATE_EXT_USERS = \"UPDATE_EXT_USERS\"\n\nconst reducer = (state, action) => {\n  const { localAudioTrack, localVideoTrack, client } = state\n  switch (action.type) {\n    case UPDATE_USERS:\n      return {\n        ...state,\n        users: action.payload,\n      }\n\n    case UPDATE_LOCAL_VIDEO_TRACK:\n      return {\n        ...state,\n        localVideoTrack: action.payload,\n      }\n    case UPDATE_LOCAL_AUDIO_TRACK:\n      return {\n        ...state,\n        localAudioTrack: action.payload,\n      }\n\n    case UPDATE_JOIN_STATE:\n      return {\n        ...state,\n        joinState: action.payload,\n      }\n\n    case LEAVE:\n      (async function leave() {\n        if (localAudioTrack) {\n          localAudioTrack.stop()\n          localAudioTrack.close()\n        }\n        if (localVideoTrack) {\n          localVideoTrack.stop()\n          localVideoTrack.close()\n        }\n        await client?.leave()\n      })()\n      return {\n        ...state,\n        users: [],\n        joinState: false,\n        status: \"leave\",\n      }\n    case UPDATE_CLIENT:\n      return {\n        ...state,\n        client: action.payload,\n      }\n    case UPDATE_STATUS:\n      return {\n        ...state,\n        status: action.payload,\n      }\n\n    case UPDATE_PERMISSION_STATE:\n      return {\n        ...state,\n        permissionState: action.payload,\n      }\n\n    case UPDATE_DEVICES:\n      return {\n        ...state,\n        devices: action.payload,\n      }\n\n    case UPDATE_DEVICES_ENABLED:\n      const {\n        devices = '',\n        enabled = undefined,\n      } = action.payload;\n\n      return {\n        ...state,\n        [`${devices}Enabled`]: enabled,\n      }\n\n    case UPDATE_DEVICES_ID:\n      const {\n        type = '',\n        id = undefined,\n      } = action.payload;\n\n      return {\n        ...state,\n        [`${type}Id`]: id,\n      }\n\n    case UPDATE_CURRENT_USR:\n      return {\n        ...state,\n        currentUser: action.payload,\n      }\n\n    case UPDATE_EXT_USERS:\n      return {\n        ...state,\n        extUsers: action.payload,\n      }\n    default:\n      return state\n  }\n}\n\nconst VoiceContext = createContext(initValue)\n\nconst ContextProvider = props => {\n  const [state, dispatch] = useReducer(reducer, initValue, val => val)\n  return (<VoiceContext.Provider value={{ state, dispatch }}>\n    {props.children}\n  </VoiceContext.Provider>)\n}\n\nexport default ContextProvider\n\nexport {\n  VoiceContext,\n  UPDATE_USERS,\n\n  UPDATE_LOCAL_VIDEO_TRACK,\n  UPDATE_LOCAL_AUDIO_TRACK,\n  UPDATE_JOIN_STATE,\n  LEAVE,\n  UPDATE_CLIENT,\n  UPDATE_STATUS,\n  UPDATE_PERMISSION_STATE,\n  UPDATE_DEVICES,\n  UPDATE_DEVICES_ENABLED,\n  UPDATE_DEVICES_ID,\n  UPDATE_CURRENT_USR,\n  UPDATE_EXT_USERS,\n}\n\n"],"names":["props","container","useRef","useEffect","current","videoTrack","play","stop","audioTrack","ref","className","StyledWrapper","styled","useContext","VoiceContext","state","localVideoTrack","users","currentUser","extUsers","length","undefined","src","photo","alt","map","user","key","uid","find","item","intUid","initValue","joinState","localAudioTrack","client","status","devices","permissionState","videoEnabled","audioEnabled","cameraId","microphoneId","UPDATE_USERS","UPDATE_LOCAL_VIDEO_TRACK","UPDATE_LOCAL_AUDIO_TRACK","UPDATE_JOIN_STATE","LEAVE","UPDATE_CLIENT","UPDATE_STATUS","UPDATE_PERMISSION_STATE","UPDATE_DEVICES","UPDATE_DEVICES_ENABLED","UPDATE_DEVICES_ID","UPDATE_CURRENT_USR","UPDATE_EXT_USERS","reducer","action","type","payload","close","leave","enabled","id","createContext","useReducer","val","dispatch","Provider","value","children"],"sourceRoot":""}