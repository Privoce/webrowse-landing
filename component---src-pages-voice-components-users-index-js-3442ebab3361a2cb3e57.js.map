{"version":3,"file":"component---src-pages-voice-components-users-index-js-3442ebab3361a2cb3e57.js","mappings":"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","sources":["webpack://webrowse-landing/./src/pages/voice/components/MediaPlayer/index.js","webpack://webrowse-landing/./src/pages/voice/components/MediaPlayer/styles.js","webpack://webrowse-landing/./src/pages/voice/components/Users/index.js","webpack://webrowse-landing/./src/pages/voice/components/Users/styles.js","webpack://webrowse-landing/./src/pages/voice/reducer.js"],"sourcesContent":["/**\n * @author: laoona\n * @date:  2022-03-01\n * @time: 14:52\n * @contact: laoona.com\n * @description: #\n */\n\nimport React, { useRef, useEffect } from \"react\"\nimport StyledWrapper from \"./styles\"\n\nconst Index = (props) => {\n  const container = useRef(null)\n  useEffect(() => {\n    if (!container.current) return\n    props.videoTrack?.play(container.current)\n    return () => {\n      props.videoTrack?.stop()\n    }\n  }, [container, props.videoTrack])\n\n  useEffect(() => {\n    if (props.audioTrack) {\n      props.audioTrack?.play()\n    }\n    return () => {\n      props.audioTrack?.stop()\n    }\n  }, [props.audioTrack])\n\n  return (\n    <StyledWrapper>\n      <div ref={container} className=\"player\" />\n    </StyledWrapper>\n  )\n}\n\nexport default Index\n","/**\n * @author: laoona\n * @date:  2022-03-18\n * @time: 22:24\n * @contact: laoona.com\n * @description: #\n */\n\nimport styled from \"styled-components\";\n\nconst StyledWrapper = styled.div`\n  .player {\n    width: 640px;\n    height: 480px;\n    background-color: #000;\n  }\n`;\n\nexport default StyledWrapper;\n","/**\n * @author: laoona\n * @date:  2022-03-18\n * @time: 17:02\n * @contact: laoona.com\n * @description: #\n */\n\nimport React, { useContext } from \"react\"\nimport StyledWrapper from \"./styles\"\nimport MediaPlayer from \"../MediaPlayer\"\nimport { VoiceContext } from \"../../reducer\"\n\nconst Users = () => {\n  const { state = {} } = useContext(VoiceContext)\n  const { localVideoTrack, users, currentUser, extUsers } = state\n\n  return <StyledWrapper>\n    <ul className={`users ${users?.length > 1 ? \"usersMore\" : \"\"}`}>\n      <li className=\"user\">\n        <MediaPlayer videoTrack={localVideoTrack} audioTrack={undefined} />\n        {\n          localVideoTrack?.muted &&\n          <div className=\"info\">\n            {\n              currentUser?.photo ?\n                <div className=\"avatar\"><img src={currentUser?.photo} className=\"pic\" alt=\"\" /></div>\n                :\n                <div className=\"name\">{currentUser?.username}</div>\n            }\n          </div>\n        }\n      </li>\n      {\n        users?.map(user =>\n          <li key={user.uid} className=\"user\">\n            <MediaPlayer videoTrack={user.videoTrack} audioTrack={user.audioTrack} />\n            {!(user.hasVideo) &&\n              <div className=\"info\">\n                {\n                  extUsers.find(item => item.intUid === user.uid)?.photo ?\n                    <div className=\"avatar\">\n                      <img\n                        src={extUsers.find(item => item.intUid === user.uid)?.photo}\n                        className=\"pic\" alt=\"\" />\n                    </div>\n                    :\n                    <div className=\"name\">{extUsers.find(item => item.intUid === user.uid)?.username}</div>\n                }\n              </div>\n            }\n          </li>\n        )\n      }\n    </ul>\n  </StyledWrapper>\n}\n\nexport default Users\n","/**\n * @author: laoona\n * @date:  2022-03-18\n * @time: 17:02\n * @contact: laoona.com\n * @description: #\n */\n\nimport styled from 'styled-components';\n\nconst StyledWrapper = styled.div`\n  display: flex;\n  height: 100%;\n  align-items: center;\n  justify-content: center;\n  .users {\n    display: flex;\n    flex-wrap: wrap;\n    justify-content: center;\n    align-items: center;\n    gap: 10px;\n    margin-bottom: 0;\n    width: 100%;\n    &More {\n      .player {\n        width: 320px;\n        height: 240px;\n      } \n    }\n  }\n  .user {\n    position: relative;\n  }\n  .info {\n    position: absolute; \n    left: 50%;\n    top: 50%;\n    transform: translate(-50%, -50%);\n  }\n  .avatar {\n    width: 160px;\n    height: 160px;\n    background-color: #333;\n    //border-radius: 8px;\n    overflow: hidden;\n    .pic {\n      width: 100%;\n      height: 100%;\n    }\n  }\n  .name {\n    color: #fff;\n    text-align: center;\n    font-size: 24px;\n  }\n  `;\n\nexport default StyledWrapper;\n","/**\n * @author: laoona\n * @date:  2022-03-18\n * @time: 17:37\n * @contact: laoona.com\n * @description: #\n */\n\nimport React, { createContext, useReducer } from \"react\"\n\n/**\n * status enums ['disconnected', 'will-join', 'connecting', 'connected', 'leave']\n * @type {{localAudioTrack: null, localVideoTrack: null, joinState: boolean, client: null, users: *[], status: string}}\n */\nconst initValue = {\n  users: [],\n  joinState: false,\n  localVideoTrack: null,\n  localAudioTrack: null,\n  client: null,\n  status: \"disconnected\",\n  devices: [],\n  permissionState: undefined, // enums ['dismissed', 'denied', 'allow', 'complete']\n  videoEnabled: true,\n  audioEnabled: true,\n  cameraId: undefined,\n  microphoneId: undefined,\n  currentUser: {}, // 当前扩展登录的用户\n  extUsers: [], // 当前扩展 Webrowse 用户列表\n}\n\nconst UPDATE_USERS = \"UPDATE_USERS\"\nconst UPDATE_LOCAL_VIDEO_TRACK = \"UPDATE_LOCAL_VIDEO_TRACK\"\nconst UPDATE_LOCAL_AUDIO_TRACK = \"UPDATE_LOCAL_AUDIO_TRACK\"\nconst UPDATE_JOIN_STATE = \"UPDATE_JOIN_STATE\"\nconst LEAVE = \"LEAVE\"\nconst UPDATE_CLIENT = \"UPDATE_CLIENT\"\nconst UPDATE_STATUS = \"UPDATE_STATUS\"\nconst UPDATE_PERMISSION_STATE = \"UPDATE_PERMISSION_STATE\"\nconst UPDATE_DEVICES = \"UPDATE_DEVICES\"\nconst UPDATE_DEVICES_ENABLED = \"UPDATE_DEVICES_ENABLED\"\nconst UPDATE_DEVICES_ID = \"UPDATE_DEVICES_ID\"\nconst UPDATE_CURRENT_USR = \"UPDATE_CURRENT_USR\"\nconst UPDATE_EXT_USERS = \"UPDATE_EXT_USERS\"\n\nconst reducer = (state, action) => {\n  const { localAudioTrack, localVideoTrack, client } = state\n  switch (action.type) {\n    case UPDATE_USERS:\n      return {\n        ...state,\n        users: action.payload,\n      }\n\n    case UPDATE_LOCAL_VIDEO_TRACK:\n      return {\n        ...state,\n        localVideoTrack: action.payload,\n      }\n    case UPDATE_LOCAL_AUDIO_TRACK:\n      return {\n        ...state,\n        localAudioTrack: action.payload,\n      }\n\n    case UPDATE_JOIN_STATE:\n      return {\n        ...state,\n        joinState: action.payload,\n      }\n\n    case LEAVE:\n      (async function leave() {\n        if (localAudioTrack) {\n          localAudioTrack.stop()\n          localAudioTrack.close()\n        }\n        if (localVideoTrack) {\n          localVideoTrack.stop()\n          localVideoTrack.close()\n        }\n        await client?.leave()\n      })()\n      return {\n        ...state,\n        users: [],\n        joinState: false,\n        status: \"leave\",\n      }\n    case UPDATE_CLIENT:\n      return {\n        ...state,\n        client: action.payload,\n      }\n    case UPDATE_STATUS:\n      return {\n        ...state,\n        status: action.payload,\n      }\n\n    case UPDATE_PERMISSION_STATE:\n      return {\n        ...state,\n        permissionState: action.payload,\n      }\n\n    case UPDATE_DEVICES:\n      return {\n        ...state,\n        devices: action.payload,\n      }\n\n    case UPDATE_DEVICES_ENABLED:\n      const {\n        devices = '',\n        enabled = undefined,\n      } = action.payload;\n\n      return {\n        ...state,\n        [`${devices}Enabled`]: enabled,\n      }\n\n    case UPDATE_DEVICES_ID:\n      const {\n        type = '',\n        id = undefined,\n      } = action.payload;\n\n      return {\n        ...state,\n        [`${type}Id`]: id,\n      }\n\n    case UPDATE_CURRENT_USR:\n      return {\n        ...state,\n        currentUser: action.payload,\n      }\n\n    case UPDATE_EXT_USERS:\n      return {\n        ...state,\n        extUsers: action.payload,\n      }\n    default:\n      return state\n  }\n}\n\nconst VoiceContext = createContext(initValue)\n\nconst ContextProvider = props => {\n  const [state, dispatch] = useReducer(reducer, initValue, val => val)\n  return (<VoiceContext.Provider value={{ state, dispatch }}>\n    {props.children}\n  </VoiceContext.Provider>)\n}\n\nexport default ContextProvider\n\nexport {\n  VoiceContext,\n  UPDATE_USERS,\n\n  UPDATE_LOCAL_VIDEO_TRACK,\n  UPDATE_LOCAL_AUDIO_TRACK,\n  UPDATE_JOIN_STATE,\n  LEAVE,\n  UPDATE_CLIENT,\n  UPDATE_STATUS,\n  UPDATE_PERMISSION_STATE,\n  UPDATE_DEVICES,\n  UPDATE_DEVICES_ENABLED,\n  UPDATE_DEVICES_ID,\n  UPDATE_CURRENT_USR,\n  UPDATE_EXT_USERS,\n}\n\n"],"names":["props","container","useRef","useEffect","current","videoTrack","play","stop","audioTrack","ref","className","StyledWrapper","styled","useContext","VoiceContext","state","localVideoTrack","users","currentUser","extUsers","length","undefined","muted","photo","src","alt","username","map","user","key","uid","hasVideo","find","item","intUid","initValue","joinState","localAudioTrack","client","status","devices","permissionState","videoEnabled","audioEnabled","cameraId","microphoneId","UPDATE_USERS","UPDATE_LOCAL_VIDEO_TRACK","UPDATE_LOCAL_AUDIO_TRACK","UPDATE_JOIN_STATE","LEAVE","UPDATE_CLIENT","UPDATE_STATUS","UPDATE_PERMISSION_STATE","UPDATE_DEVICES","UPDATE_DEVICES_ENABLED","UPDATE_DEVICES_ID","UPDATE_CURRENT_USR","UPDATE_EXT_USERS","reducer","action","type","payload","close","leave","enabled","id","createContext","useReducer","val","dispatch","Provider","value","children"],"sourceRoot":""}