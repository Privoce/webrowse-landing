"use strict";(self.webpackChunkwebrowse_landing=self.webpackChunkwebrowse_landing||[]).push([[6722,5260,7248],{1792:function(e,t,n){n.r(t);var a=n(8634),o=n(2656),l=n.n(o),i=n(7294),r=n(9287),c=n(9417),s=n(7539),u=n(6963),d=n.n(u),p=n(5414);t.default=function(){var e=(0,i.useContext)(r.VoiceContext),t=e.state,n=e.dispatch,o=(0,i.useState)(void 0),u=o[0],m=o[1],v=(0,i.useState)([]),f=v[0],b=v[1],g=function(){d().getDevices().then((function(e){b(e),m("allow")})).catch((function(e){var t="denied";switch(!0){case e.toString().indexOf("Permission dismissed")>-1:t="dismissed";break;case e.toString().indexOf("Permission denied")>-1:t="denied"}m(t)}))};(0,i.useEffect)((function(){g()}),[]),(0,i.useEffect)((function(){var e=function(){var e=(0,a.Z)(l().mark((function e(t){var a,o,i,c,s,u;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.data||{},o=a.source,i=a.event,c=a.payload,console.log("user message",t.data),"webrowse.ext"===o){e.next=4;break}return e.abrupt("return");case 4:e.t0=i,e.next="webrows_users"===e.t0?7:"leave"===e.t0?12:14;break;case 7:return s=(null==c?void 0:c.users)||[],u=(null==c?void 0:c.currentUser)||{},n({type:r.UPDATE_CURRENT_USR,payload:u}),n({type:r.UPDATE_EXT_USERS,payload:s}),e.abrupt("break",15);case 12:return n({type:r.LEAVE}),e.abrupt("break",15);case 14:return e.abrupt("break",15);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return window.addEventListener("message",e),function(){window.removeEventListener("message",e)}}),[]),(0,i.useEffect)((function(){void 0!==u&&(null==n||n({type:r.UPDATE_PERMISSION_STATE,payload:u}))}),[u]);var E=(t||{}).permissionState;return console.log(E,"permissionState"),void 0===E?null:i.createElement(i.Fragment,null,i.createElement(p.q,{bodyAttributes:{class:"view-voice"}}),"complete"===E?i.createElement(c.default,null):i.createElement(s.default,{devices:f,access:g}))}},6768:function(e,t,n){n.r(t);var a=n(7294),o=n(9),l=n(3003),i=o.default.div.withConfig({displayName:"Selector__StyledSelector",componentId:"sc-8ljg19-0"})([".selector{width:380px;padding:0 12px;box-sizing:border-box;border:1px solid rgba(208,213,221,1);border-radius:8px;display:flex;align-items:center;}.icon{}.selectMain{position:relative;width:100%;flex:1;margin:0 6px;}.select{width:100%;height:44px;opacity:0;cursor:pointer;}.value{position:absolute;line-height:44px;font-size:16px;color:rgba(52,64,84,1);}"]);t.default=function(e){var t,n=e.icon,o=void 0===n?null:n,r=e.data,c=void 0===r?[]:r,s=e.value,u=void 0===s?"default":s,d=e.onChange,p=void 0===d?function(){}:d;return a.createElement(i,null,a.createElement("div",{className:"selector"},o,a.createElement("div",{className:"selectMain"},a.createElement("div",{className:"value"},a.createElement("span",{className:"textLineClamp-1"},null===(t=c.find((function(e){return e.deviceId===u})))||void 0===t?void 0:t.label)),a.createElement("select",{className:"select",onChange:function(e){console.log(e.target.value,"ev"),p(e.target.value)}},null==c?void 0:c.map((function(e){return a.createElement("option",{key:e.deviceId,value:e.deviceId},e.label)})))),a.createElement(l.DropDown,null)))}},7539:function(e,t,n){n.r(t);var a=n(8634),o=n(2656),l=n.n(o),i=n(7294),r=n(5478),c=n(6768),s=n(3003),u=n(9287),d=n(5728),p=n(6963),m=n.n(p),v=n(5473);t.default=function(e){var t=e.devices,n=void 0===t?[]:t,o=e.access,p=void 0===o?function(){}:o,f=(0,i.useRef)(null),b=(0,i.useContext)(u.VoiceContext),g=b.state,E=b.dispatch,h=(0,i.useState)(""),x=h[0],y=h[1],w=(0,i.useState)(""),k=w[0],S=w[1],C=(0,i.useState)(""),I=C[0],N=C[1],_=(0,i.useState)(null),T=_[0],D=_[1],A=(0,i.useState)(null),U=A[0],M=A[1],P=(0,i.useState)(0),V=P[0],L=P[1],R=null==g?void 0:g.permissionState,z=g||{},j=z.videoEnabled,B=z.audioEnabled;(0,i.useEffect)((function(){var e,t,a,o=null===(e=n.find((function(e){return"audioinput"===e.kind})))||void 0===e?void 0:e.deviceId;y(o);var l=null===(t=n.find((function(e){return"audioinput"===e.kind})))||void 0===t?void 0:t.deviceId;S(l);var i=null===(a=n.find((function(e){return"videoinput"===e.kind})))||void 0===a?void 0:a.deviceId;N(i)}),[n]),(0,i.useEffect)((function(){var e,t;if(x&&I)return(0,a.Z)(l().mark((function n(){var a;return l().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,m().createMicrophoneAndCameraTracks({microphoneId:x},{cameraId:I});case 2:a=n.sent,e=a[0],t=a[1],D(e),M(t),f=setInterval((function(){var t,n=null===(t=e)||void 0===t?void 0:t.getVolumeLevel();console.log("local stream audio level",n),L(n)}),200);case 8:case"end":return n.stop()}}),n)})))(),E({type:u.UPDATE_DEVICES_ID,payload:{type:"camera",id:I}}),E({type:u.UPDATE_DEVICES_ID,payload:{type:"microphone",id:x}}),function(){e=null,t=null,clearInterval(f),null==T||T.close(),null==U||U.close()}}),[x,I]);console.log(R,"permissionStatus");return i.createElement(r.default,null,i.createElement("div",{className:"modal"},i.createElement("div",null,i.createElement("h3",{className:"title"},"Privoce Daily Meeting"),"allow"===R&&i.createElement("div",{className:"playerWrap"},i.createElement(d.default,{videoTrack:U,audioTrack:null}),i.createElement("div",{className:"buttons"},i.createElement(v.default,{onClick:function(){return E({type:u.UPDATE_DEVICES_ENABLED,payload:{devices:"video",enabled:!j}})},type:"cam",label:null,disabled:!j}),i.createElement(v.default,{onClick:function(){return E({type:u.UPDATE_DEVICES_ENABLED,payload:{devices:"audio",enabled:!B}})},label:null,volumeLevel:V,disabled:!B}))),function(e){return void 0===e&&(e=[]),e.length?i.createElement(i.Fragment,null,i.createElement(c.default,{value:I,icon:i.createElement(s.Camera,null),data:e.filter((function(e){return"videoinput"===e.kind})),onChange:function(e){N(e)}}),i.createElement("div",{className:"space"}),i.createElement(c.default,{value:x,icon:i.createElement(s.Mic,null),data:e.filter((function(e){return"audioinput"===e.kind})),onChange:function(e){y(e)}}),i.createElement("div",{className:"space"}),i.createElement(c.default,{value:k,icon:i.createElement(s.Speaker,null),data:e.filter((function(e){return"audiooutput"===e.kind})),onChange:function(e){S(e)}})):null}(n),i.createElement("div",{className:"statusText"},"allow"===R?"In order for others to hear you, your browser will request microphone access.":"We donâ€™t have access to your Microphone and Mic."),i.createElement("div",{className:"descText"},"Warning: Voice only works in one tab, Make sure do not close the tab you started Voice with, once you close the tab, you have to restart again.")),i.createElement("div",null,"allow"===R?i.createElement("button",{className:"button",onClick:function(){E({type:u.UPDATE_PERMISSION_STATE,payload:"complete"}),E({type:u.UPDATE_STATUS,payload:"will-join"}),null==T||T.close(),null==U||U.close()}},"Join Meeting"):i.createElement("button",{className:"button",onClick:p},"Request access"))))}},5478:function(e,t,n){n.r(t);var a=n(9).default.section.withConfig({displayName:"styles__StyledDevices",componentId:"sc-tn8d7h-0"})(["width:100vw;height:100vh;background:#fff;display:flex;align-items:center;justify-content:center;.modal{display:flex;flex-direction:column;justify-content:space-between;padding:32px 16px;box-sizing:border-box;width:412px;min-height:462px;box-shadow:0px 4px 14px 2px rgba(0,0,0,0.16);border-radius:8px;}.title{font-size:20px;color:rgba(68,73,79,1);line-height:30px;text-align:center;margin-bottom:32px;}.space{height:8px;}.statusText{margin:32px 0 8px;text-align:center;word-break:break-all;font-size:16px;color:rgba(68,73,79,1);line-height:24px;}.descText{text-align:center;word-break:break-all;font-size:12px;color:rgba(92,96,101,1);line-height:18px;}.button{display:block;width:150px;height:32px;border:none;background-color:rgba(82,237,255,1);color:rgba(25,24,29,1);margin:32px auto 0;border-radius:50px;cursor:pointer;}.playerWrap{position:relative;height:240px;margin:0 -16px;background-color:rgba(25,24,29,1);margin-bottom:16px;.player{width:100%;height:240px;}.buttons{position:absolute;left:50%;transform:translateX(-50%);bottom:16px;display:flex;}}"]);t.default=a},5473:function(e,t,n){n.r(t);var a=n(3003),o=n(7294),l=n(9).default.div.withConfig({displayName:"Button__StyledButton",componentId:"sc-152vati-0"})([".button{border:none;background:none !important;cursor:pointer;margin:0 !important;width:auto !important;height:auto !important;&:disabled{opacity:0.3;}&Icon{position:relative;width:48px;height:48px;background-color:#f26b4d;border-radius:12px;display:flex;align-items:center;justify-content:center;overflow:hidden;&:hover{background-color:#c35037;}}.text{color:#fff;font-size:14px;margin-top:10px;text-align:center;}&Inner{}.level{transition:height 0.3s;position:absolute;left:0;bottom:0;width:100%;height:0;background-color:rgba(0,0,0,.35);}}"]),i=new Map([["mic",[o.createElement(a.Audio,null),o.createElement(a.AudioClose,null)]],["cam",[o.createElement(a.Video,null),o.createElement(a.VideoClose,null)]]]);new Map([["mic","Mic"],["cam","Cam"]]);t.default=function(e){var t,n=e.onClick,a=void 0===n?function(){}:n,r=e.label,c=void 0===r||r,s=e.disabled,u=void 0!==s&&s,d=e.volumeLevel,p=void 0===d?0:d,m=e.type,v=void 0===m?"mic":m;return o.createElement(l,null,o.createElement("button",{onClick:a,className:"button"},o.createElement("div",{className:"buttonInner"},o.createElement("div",{className:"buttonIcon"},null===(t=i.get(v))||void 0===t?void 0:t[u?1:0],o.createElement("span",{style:{height:100*p+"px"},className:"level"})),c&&o.createElement("div",{className:"text"},v.replace(v[0],v[0].toUpperCase())))))}}}]);
//# sourceMappingURL=component---src-pages-voice-main-js-c5770449e7e48397e603.js.map