{"version":3,"file":"component---src-pages-voice-reducer-js-a2e88b1b0e925a955796.js","mappings":"grBAcA,MAAMA,EAAY,CAChBC,MAAO,GACPC,WAAW,EACXC,gBAAiB,KACjBC,gBAAiB,KACjBC,OAAQ,KACRC,OAAQ,eACRC,QAAS,GACTC,qBAAiBC,EACjBC,cAAc,EACdC,cAAc,EACdC,cAAUH,EACVI,kBAAcJ,EACdK,YAAa,CAAC,EACdC,SAAU,IAGNC,EAAe,eACfC,EAA2B,2BAC3BC,EAA2B,2BAC3BC,EAAoB,oBACpBC,EAAQ,QACRC,EAAgB,gBAChBC,EAAgB,gBAChBC,EAA0B,0BAC1BC,EAAiB,iBACjBC,EAAyB,yBACzBC,EAAoB,oBACpBC,EAAqB,qBACrBC,EAAmB,mBAEnBC,EAAUA,CAACC,EAAOC,KACtB,MAAM,gBAAE3B,EAAe,gBAAED,EAAe,OAAEE,GAAWyB,EACrD,OAAQC,EAAOC,MACb,KAAKhB,EACH,MAAO,IACFc,EACH7B,MAAO8B,EAAOE,SAGlB,KAAKhB,EACH,MAAO,IACFa,EACH3B,gBAAiB4B,EAAOE,SAE5B,KAAKf,EACH,MAAO,IACFY,EACH1B,gBAAiB2B,EAAOE,SAG5B,KAAKd,EACH,MAAO,IACFW,EACH5B,UAAW6B,EAAOE,SAGtB,KAAKb,EAYH,OAXA,iBACMhB,IACFA,EAAgB8B,OAChB9B,EAAgB+B,SAEdhC,IACFA,EAAgB+B,OAChB/B,EAAgBgC,eAEZ9B,aAAM,EAANA,EAAQ+B,QACf,CAVD,GAWO,IACFN,EACH7B,MAAO,GACPC,WAAW,EACXI,OAAQ,SAEZ,KAAKe,EACH,MAAO,IACFS,EACHzB,OAAQ0B,EAAOE,SAEnB,KAAKX,EACH,MAAO,IACFQ,EACHxB,OAAQyB,EAAOE,SAGnB,KAAKV,EACH,MAAO,IACFO,EACHtB,gBAAiBuB,EAAOE,SAG5B,KAAKT,EACH,MAAO,IACFM,EACHvB,QAASwB,EAAOE,SAGpB,KAAKR,EACH,MAAM,QACJlB,EAAU,GAAE,QACZ8B,GACEN,EAAOE,QAEX,MAAO,IACFH,EACH,CAAIvB,EAAO,WAAY8B,GAG3B,KAAKX,EACH,MAAM,KACJM,EAAO,GAAE,GACTM,GACEP,EAAOE,QAEX,MAAO,IACFH,EACH,CAAIE,EAAI,MAAOM,GAGnB,KAAKX,EACH,MAAO,IACFG,EACHhB,YAAaiB,EAAOE,SAGxB,KAAKL,EACH,MAAO,IACFE,EACHf,SAAUgB,EAAOE,SAErB,QACE,OAAOH,EACX,EAGIS,GAAeC,EAAAA,EAAAA,eAAcxC,GASnC,UAPwByC,IACtB,MAAM,EAACX,EAAM,EAACY,IAAYC,EAAAA,EAAAA,YAAWd,EAAS7B,GAAW4C,GAAOA,IAChE,OAAQC,EAAAA,cAACN,EAAaO,SAAQ,CAACC,MAAO,CAAEjB,QAAOY,aAC5CD,EAAMO,SACe,C","sources":["webpack://webrowse-landing/./src/pages/voice/reducer.js"],"sourcesContent":["/**\n * @author: laoona\n * @date:  2022-03-18\n * @time: 17:37\n * @contact: laoona.com\n * @description: #\n */\n\nimport React, { createContext, useReducer } from \"react\"\n\n/**\n * status enums ['disconnected', 'will-join', 'connecting', 'connected', 'leave']\n * @type {{localAudioTrack: null, localVideoTrack: null, joinState: boolean, client: null, users: *[], status: string}}\n */\nconst initValue = {\n  users: [],\n  joinState: false,\n  localVideoTrack: null,\n  localAudioTrack: null,\n  client: null,\n  status: \"disconnected\",\n  devices: [],\n  permissionState: undefined, // enums ['dismissed', 'denied', 'allow', 'complete']\n  videoEnabled: true,\n  audioEnabled: true,\n  cameraId: undefined,\n  microphoneId: undefined,\n  currentUser: {}, // 当前扩展登录的用户\n  extUsers: [], // 当前扩展 Webrowse 用户列表\n}\n\nconst UPDATE_USERS = \"UPDATE_USERS\"\nconst UPDATE_LOCAL_VIDEO_TRACK = \"UPDATE_LOCAL_VIDEO_TRACK\"\nconst UPDATE_LOCAL_AUDIO_TRACK = \"UPDATE_LOCAL_AUDIO_TRACK\"\nconst UPDATE_JOIN_STATE = \"UPDATE_JOIN_STATE\"\nconst LEAVE = \"LEAVE\"\nconst UPDATE_CLIENT = \"UPDATE_CLIENT\"\nconst UPDATE_STATUS = \"UPDATE_STATUS\"\nconst UPDATE_PERMISSION_STATE = \"UPDATE_PERMISSION_STATE\"\nconst UPDATE_DEVICES = \"UPDATE_DEVICES\"\nconst UPDATE_DEVICES_ENABLED = \"UPDATE_DEVICES_ENABLED\"\nconst UPDATE_DEVICES_ID = \"UPDATE_DEVICES_ID\"\nconst UPDATE_CURRENT_USR = \"UPDATE_CURRENT_USR\"\nconst UPDATE_EXT_USERS = \"UPDATE_EXT_USERS\"\n\nconst reducer = (state, action) => {\n  const { localAudioTrack, localVideoTrack, client } = state\n  switch (action.type) {\n    case UPDATE_USERS:\n      return {\n        ...state,\n        users: action.payload,\n      }\n\n    case UPDATE_LOCAL_VIDEO_TRACK:\n      return {\n        ...state,\n        localVideoTrack: action.payload,\n      }\n    case UPDATE_LOCAL_AUDIO_TRACK:\n      return {\n        ...state,\n        localAudioTrack: action.payload,\n      }\n\n    case UPDATE_JOIN_STATE:\n      return {\n        ...state,\n        joinState: action.payload,\n      }\n\n    case LEAVE:\n      (async function leave() {\n        if (localAudioTrack) {\n          localAudioTrack.stop()\n          localAudioTrack.close()\n        }\n        if (localVideoTrack) {\n          localVideoTrack.stop()\n          localVideoTrack.close()\n        }\n        await client?.leave()\n      })()\n      return {\n        ...state,\n        users: [],\n        joinState: false,\n        status: \"leave\",\n      }\n    case UPDATE_CLIENT:\n      return {\n        ...state,\n        client: action.payload,\n      }\n    case UPDATE_STATUS:\n      return {\n        ...state,\n        status: action.payload,\n      }\n\n    case UPDATE_PERMISSION_STATE:\n      return {\n        ...state,\n        permissionState: action.payload,\n      }\n\n    case UPDATE_DEVICES:\n      return {\n        ...state,\n        devices: action.payload,\n      }\n\n    case UPDATE_DEVICES_ENABLED:\n      const {\n        devices = '',\n        enabled = undefined,\n      } = action.payload;\n\n      return {\n        ...state,\n        [`${devices}Enabled`]: enabled,\n      }\n\n    case UPDATE_DEVICES_ID:\n      const {\n        type = '',\n        id = undefined,\n      } = action.payload;\n\n      return {\n        ...state,\n        [`${type}Id`]: id,\n      }\n\n    case UPDATE_CURRENT_USR:\n      return {\n        ...state,\n        currentUser: action.payload,\n      }\n\n    case UPDATE_EXT_USERS:\n      return {\n        ...state,\n        extUsers: action.payload,\n      }\n    default:\n      return state\n  }\n}\n\nconst VoiceContext = createContext(initValue)\n\nconst ContextProvider = props => {\n  const [state, dispatch] = useReducer(reducer, initValue, val => val)\n  return (<VoiceContext.Provider value={{ state, dispatch }}>\n    {props.children}\n  </VoiceContext.Provider>)\n}\n\nexport default ContextProvider\n\nexport {\n  VoiceContext,\n  UPDATE_USERS,\n\n  UPDATE_LOCAL_VIDEO_TRACK,\n  UPDATE_LOCAL_AUDIO_TRACK,\n  UPDATE_JOIN_STATE,\n  LEAVE,\n  UPDATE_CLIENT,\n  UPDATE_STATUS,\n  UPDATE_PERMISSION_STATE,\n  UPDATE_DEVICES,\n  UPDATE_DEVICES_ENABLED,\n  UPDATE_DEVICES_ID,\n  UPDATE_CURRENT_USR,\n  UPDATE_EXT_USERS,\n}\n\n"],"names":["initValue","users","joinState","localVideoTrack","localAudioTrack","client","status","devices","permissionState","undefined","videoEnabled","audioEnabled","cameraId","microphoneId","currentUser","extUsers","UPDATE_USERS","UPDATE_LOCAL_VIDEO_TRACK","UPDATE_LOCAL_AUDIO_TRACK","UPDATE_JOIN_STATE","LEAVE","UPDATE_CLIENT","UPDATE_STATUS","UPDATE_PERMISSION_STATE","UPDATE_DEVICES","UPDATE_DEVICES_ENABLED","UPDATE_DEVICES_ID","UPDATE_CURRENT_USR","UPDATE_EXT_USERS","reducer","state","action","type","payload","stop","close","leave","enabled","id","VoiceContext","createContext","props","dispatch","useReducer","val","React","Provider","value","children"],"sourceRoot":""}