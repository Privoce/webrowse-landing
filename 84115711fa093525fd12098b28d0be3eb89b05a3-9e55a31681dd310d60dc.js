"use strict";(self.webpackChunkwebrowse_landing=self.webpackChunkwebrowse_landing||[]).push([[2823,5260,7248,3615,3754,8091,299],{1903:function(e,t,n){n.r(t);var a=n(7294),o=n(77),l=n(7289),i=n(265),r=n(6963),c=n.n(r),s=n(5414);t.default=()=>{const{state:e,dispatch:t}=(0,a.useContext)(o.VoiceContext),{0:n,1:r}=(0,a.useState)(void 0),{0:d,1:u}=(0,a.useState)([]),m=(0,a.useRef)(null),p=()=>{c().getDevices().then((e=>{u(e),r("allow")})).catch((e=>{let t="denied";switch(!0){case e.toString().indexOf("Permission dismissed")>-1:t="dismissed";break;case e.toString().indexOf("Permission denied")>-1:t="denied"}r(t)}))};(0,a.useEffect)((()=>{p()}),[]),(0,a.useEffect)((()=>{const n=async n=>{var a;const{source:l,event:i,payload:r}=n.data||{};if("webrowse.ext"===l)switch(i){case"webrowse_users":const n=(null==r?void 0:r.users)||[],l=(null==r?void 0:r.currentUser)||{};t({type:o.UPDATE_CURRENT_USR,payload:l}),t({type:o.UPDATE_EXT_USERS,payload:n});break;case"leave":t({type:o.LEAVE});break;case"join":"complete"===(null==e?void 0:e.permissionState)?t({type:o.UPDATE_STATUS,payload:"will-join"}):null==m||null===(a=m.current)||void 0===a||a.join();break;case"mute":{const n=null==r?void 0:r.type,a="video"===n?null==e?void 0:e.videoEnabled:null==e?void 0:e.audioEnabled;t({type:o.UPDATE_DEVICES_ENABLED,payload:{devices:n,enabled:!a}})}}};return window.addEventListener("message",n),()=>{window.removeEventListener("message",n)}}),[null==e?void 0:e.permissionState,null==e?void 0:e.videoEnabled,null==e?void 0:e.audioEnabled]),(0,a.useEffect)((()=>{void 0!==n&&(null==t||t({type:o.UPDATE_PERMISSION_STATE,payload:n}))}),[n]);const{permissionState:f}=e||{};return console.log(f,"permissionState"),void 0===f?null:a.createElement(a.Fragment,null,a.createElement(s.q,{bodyAttributes:{class:"view-voice"}}),"complete"===f?a.createElement(l.default,null):a.createElement(i.default,{ref:m,devices:d,access:p}))}},7289:function(e,t,n){n.r(t),n.d(t,{default:function(){return E}});var a=n(7294),o=n(6963),l=n.n(o);const i="733ebd8906c84f8baafcbf548dcfe7da";function r(e){const{0:t,1:n}=(0,a.useState)(void 0),{0:o,1:r}=(0,a.useState)(void 0),{0:c,1:s}=(0,a.useState)([]),{0:d,1:u}=(0,a.useState)(""),{0:m,1:p}=(0,a.useState)(null),{0:f,1:v}=(0,a.useState)(!1),{0:E,1:b}=(0,a.useState)([]),{0:h,1:g}=(0,a.useState)([]),y=async(e,t)=>{const n=await fetch("https://wechat.okeydemo.com/api/agora/get_token?uid="+e+"&channel="+t);return await n.text()};(0,a.useEffect)((()=>{e&&(async()=>{const e=await l().getDevices();s(e)})()}),[e]);const x=(0,a.useCallback)((async function(t,a,o,c){if(!e||!a)return;e.enableAudioVolumeIndicator(),p(a),u(t);const s=await y(a,t),[d,m]=await async function(e,t){const[a,o]=await l().createMicrophoneAndCameraTracks(e,t);return r(a),n(o),[a,o]}(o,c);await e.join(i,t,s||null,+a),await e.publish([d,m]),window.client=e,window.videoTrack=m,v(!0)}),[]);return(0,a.useEffect)((()=>{if(!e)return;b(e.remoteUsers);const t=async(t,n)=>{await e.subscribe(t,n),b((t=>Array.from(e.remoteUsers)))},n=t=>{b((t=>Array.from(e.remoteUsers)))},a=t=>{b((t=>Array.from(e.remoteUsers)))},o=t=>{b((t=>Array.from(e.remoteUsers)))};return e.on("user-published",t),e.on("user-unpublished",n),e.on("user-joined",a),e.on("user-left",o),()=>{e.off("user-published",t),e.off("user-unpublished",n),e.off("user-joined",a),e.off("user-left",o)}}),[e]),(0,a.useEffect)((()=>{if(!e||!d||!m)return;const t=async()=>{console.log("WillExpire");const t=await y(m,d);await e.renewToken(t)},n=async()=>{console.log("Fetching the new Token");const t=await y(m,d);console.log("Rejoining the channel with new Token"),await e.join(i,d,t,m)},a=e=>{g(e),e.forEach(((e,t)=>{console.log(t+" UID "+e.uid+" Level "+e.level)}))};return e.on("token-privilege-will-expire",t),e.on("token-privilege-did-expire",n),e.on("volume-indicator",a),()=>{e.off("token-privilege-will-expire",t),e.off("token-privilege-did-expire",n),e.off("volume-indicator",a)}}),[e,d,m]),{localAudioTrack:o,localVideoTrack:t,joinState:f,leave:async function(){o&&(o.stop(),o.close()),t&&(t.stop(),t.close()),b([]),v(!1),await(null==e?void 0:e.leave())},join:x,remoteUsers:E,devices:c,volumes:h}}var c=n(8278),s=n(8570),d=n(1367),u=n(77),m=n(9390);var p,f=n(1720);const v=null===l()||void 0===l()||null===(p=l().createClient)||void 0===p?void 0:p.call(l(),{codec:"h264",mode:"rtc"});var E=()=>{const{dispatch:e,state:t}=(0,a.useContext)(u.VoiceContext),{status:n,cameraId:o,microphoneId:l,currentUser:i,users:p}=t||{},E=new URLSearchParams("undefined"!=typeof window?window.location.search:""),b=(null==i?void 0:i.intUid)||(()=>{const e="123456789",t=[];for(let n=0;n<9;n++)t[n]=e.charAt(9*Math.random());return+t.join("")})()||+E.get("uid")||1,h=E.get("cid")||"test",{localAudioTrack:g,localVideoTrack:y,join:x,joinState:w,remoteUsers:k}=r(v);(0,a.useEffect)((()=>{e({type:u.UPDATE_CLIENT,payload:v})}),[]),(0,a.useEffect)((()=>{}),[b,h]),(0,a.useEffect)((()=>{y&&g&&(e({type:u.UPDATE_LOCAL_VIDEO_TRACK,payload:y}),e({type:u.UPDATE_LOCAL_AUDIO_TRACK,payload:g}))}),[y,g]),(0,a.useEffect)((()=>{e({type:u.UPDATE_JOIN_STATE,payload:w})}),[w]),(0,a.useEffect)((()=>{var e;const n={source:"webrow.se/voice",payload:{status:null==t?void 0:t.status},event:"connect"};null===(e=window)||void 0===e||e.postMessage(n,"*")}),[null==t?void 0:t.status]),(0,a.useEffect)((()=>{(async()=>{"will-join"===(null==t?void 0:t.status)&&await S({microphoneId:l},{cameraId:o})})()}),[null==t?void 0:t.status,o,l]),(0,a.useEffect)((()=>{e({type:u.UPDATE_USERS,payload:k})}),[k]),(0,a.useEffect)((()=>{var e;const n=p.map((e=>{let{uid:t,hasVideo:n,hasAudio:a}=e;return{uid:t,hasVideo:n,hasAudio:a,current:!1}}));null!=t&&t.joinState&&n.unshift({uid:null==i?void 0:i.intUid,hasVideo:null==t?void 0:t.videoEnabled,hasAudio:null==t?void 0:t.audioEnabled,current:!0});const a={source:"webrow.se/voice",payload:{remoteUsers:n},event:"remote_users"};null===(e=window)||void 0===e||e.postMessage(a,"*")}),[p,null==i?void 0:i.intUid,null==t?void 0:t.joinState,null==t?void 0:t.videoEnabled,null==t?void 0:t.audioEnabled]);const S=async(t,n)=>{e({type:u.UPDATE_STATUS,payload:"connecting"}),await x(h,b,t,n),e({type:u.UPDATE_JOIN_STATE,payload:!0}),e({type:u.UPDATE_STATUS,payload:"connected"})};return a.createElement(s.default,null,a.createElement("header",{className:"header"},a.createElement("h1",{className:"title"},a.createElement("img",{className:"logo",src:f.Z,alt:""})),a.createElement("h2",{className:"sub_title"},"Sync tabs with your teammates!")),null!=t&&t.joinState?a.createElement(a.Fragment,null,a.createElement(d.default,null),a.createElement(c.default,null)):a.createElement("div",{className:"joinWrap"},a.createElement("button",{disabled:"connecting"===n,className:"button",onClick:()=>S({microphoneId:l},{cameraId:o})},a.createElement("div",{className:"inner"},a.createElement(m.JoinRoom,null)),"connecting"===n?"connecting":"Join")))}},1722:function(e,t,n){n.r(t);var a=n(7294),o=n(3494),l=n(9390);const i=o.default.div.withConfig({displayName:"Selector__StyledSelector",componentId:"sc-8ljg19-0"})([".selector{width:380px;padding:0 12px;box-sizing:border-box;border:1px solid rgba(208,213,221,1);border-radius:8px;display:flex;align-items:center;}.icon{}.selectMain{position:relative;width:100%;flex:1;margin:0 6px;}.select{width:100%;height:44px;opacity:0;cursor:pointer;}.value{position:absolute;line-height:44px;font-size:16px;color:rgba(52,64,84,1);}"]);t.default=e=>{var t;let{icon:n=null,data:o=[],value:r="default",onChange:c=(()=>{})}=e;return a.createElement(i,null,a.createElement("div",{className:"selector"},n,a.createElement("div",{className:"selectMain"},a.createElement("div",{className:"value"},a.createElement("span",{className:"textLineClamp-1"},null===(t=o.find((e=>e.deviceId===r)))||void 0===t?void 0:t.label)),a.createElement("select",{className:"select",onChange:e=>{console.log(e.target.value,"ev"),c(e.target.value)}},null==o?void 0:o.map((e=>a.createElement("option",{key:e.deviceId,value:e.deviceId},e.label))))),a.createElement(l.DropDown,null)))}},265:function(e,t,n){n.r(t);var a=n(7294),o=n(4778),l=n(1722),i=n(9390),r=n(77),c=n(881),s=n(6963),d=n.n(s),u=n(7707);const m=(e,t)=>{let{devices:n=[],access:s=(()=>{})}=e,m=(0,a.useRef)(null);const{state:p,dispatch:f}=(0,a.useContext)(r.VoiceContext),{0:v,1:E}=(0,a.useState)(""),{0:b,1:h}=(0,a.useState)(""),{0:g,1:y}=(0,a.useState)(""),{0:x,1:w}=(0,a.useState)(null),{0:k,1:S}=(0,a.useState)(null),{0:N,1:T}=(0,a.useState)(0),C=null==p?void 0:p.permissionState,{videoEnabled:A,audioEnabled:_}=p||{};(0,a.useEffect)((()=>{var e,t,a;const o=null===(e=n.find((e=>"audioinput"===e.kind)))||void 0===e?void 0:e.deviceId;E(o);const l=null===(t=n.find((e=>"audioinput"===e.kind)))||void 0===t?void 0:t.deviceId;h(l);const i=null===(a=n.find((e=>"videoinput"===e.kind)))||void 0===a?void 0:a.deviceId;y(i)}),[n]),(0,a.useEffect)((()=>{if(!v||!g)return;let e,t;return(async()=>{[e,t]=await d().createMicrophoneAndCameraTracks({microphoneId:v},{cameraId:g}),w(e),S(t),m=setInterval((()=>{var t;const n=null===(t=e)||void 0===t?void 0:t.getVolumeLevel();console.log("local stream audio level",n),T(n)}),200)})(),f({type:r.UPDATE_DEVICES_ID,payload:{type:"camera",id:g}}),f({type:r.UPDATE_DEVICES_ID,payload:{type:"microphone",id:v}}),()=>{e=null,t=null,clearInterval(m),null==x||x.close(),null==k||k.close()}}),[v,g]);const I=()=>{f({type:r.UPDATE_PERMISSION_STATE,payload:"complete"}),f({type:r.UPDATE_STATUS,payload:"will-join"}),null==x||x.close(),null==k||k.close()};(0,a.useImperativeHandle)(t,(()=>({join(){I()}})));return a.createElement(o.default,null,a.createElement("div",{className:"modal"},a.createElement("div",null,a.createElement("h3",{className:"title"},"Privoce Daily Meeting"),"allow"===C&&a.createElement("div",{className:"playerWrap"},a.createElement(c.default,{videoTrack:k,audioTrack:null}),a.createElement("div",{className:"buttons"},a.createElement(u.default,{onClick:()=>f({type:r.UPDATE_DEVICES_ENABLED,payload:{devices:"video",enabled:!A}}),type:"cam",label:null,disabled:!A}),a.createElement(u.default,{onClick:()=>f({type:r.UPDATE_DEVICES_ENABLED,payload:{devices:"audio",enabled:!_}}),label:null,volumeLevel:N,disabled:!_}))),function(e){return void 0===e&&(e=[]),e.length?a.createElement(a.Fragment,null,a.createElement(l.default,{value:g,icon:a.createElement(i.Camera,null),data:e.filter((e=>"videoinput"===e.kind)),onChange:e=>{y(e)}}),a.createElement("div",{className:"space"}),a.createElement(l.default,{value:v,icon:a.createElement(i.Mic,null),data:e.filter((e=>"audioinput"===e.kind)),onChange:e=>{E(e)}}),a.createElement("div",{className:"space"}),a.createElement(l.default,{value:b,icon:a.createElement(i.Speaker,null),data:e.filter((e=>"audiooutput"===e.kind)),onChange:e=>{h(e)}})):null}(n),a.createElement("div",{className:"statusText"},"allow"===C?"In order for others to hear you, your browser will request microphone access.":"We don’t have access to your Microphone and Mic."),a.createElement("div",{className:"descText"},"Warning: Voice only works in one tab, Make sure do not close the tab you started Voice with, once you close the tab, you have to restart again.")),a.createElement("div",null,"allow"===C?a.createElement("button",{className:"button",onClick:I},"Join Meeting"):a.createElement("button",{className:"button",onClick:s},"Request access"))))};t.default=(0,a.forwardRef)(m)},4778:function(e,t,n){n.r(t);const a=n(3494).default.section.withConfig({displayName:"styles__StyledDevices",componentId:"sc-tn8d7h-0"})(["width:100vw;height:100vh;background:#fff;display:flex;align-items:center;justify-content:center;.modal{display:flex;flex-direction:column;justify-content:space-between;padding:32px 16px;box-sizing:border-box;width:412px;min-height:462px;box-shadow:0px 4px 14px 2px rgba(0,0,0,0.16);border-radius:8px;}.title{font-size:20px;color:rgba(68,73,79,1);line-height:30px;text-align:center;margin-bottom:32px;}.space{height:8px;}.statusText{margin:32px 0 8px;text-align:center;word-break:break-all;font-size:16px;color:rgba(68,73,79,1);line-height:24px;}.descText{text-align:center;word-break:break-all;font-size:12px;color:rgba(92,96,101,1);line-height:18px;}.button{display:block;width:150px;height:32px;border:none;background-color:rgba(82,237,255,1);color:rgba(25,24,29,1);margin:32px auto 0;border-radius:50px;cursor:pointer;}.playerWrap{position:relative;height:240px;margin:0 -16px;background-color:rgba(25,24,29,1);margin-bottom:16px;.player{width:100%;height:240px;}.buttons{position:absolute;left:50%;transform:translateX(-50%);bottom:16px;display:flex;}}"]);t.default=a},7707:function(e,t,n){n.r(t);var a=n(9390),o=n(7294);const l=n(3494).default.div.withConfig({displayName:"Button__StyledButton",componentId:"sc-152vati-0"})([".button{border:none;background:none !important;cursor:pointer;margin:0 !important;width:auto !important;height:auto !important;&:disabled{opacity:0.3;}&Icon{position:relative;width:48px;height:48px;background-color:#f26b4d;border-radius:12px;display:flex;align-items:center;justify-content:center;overflow:hidden;&:hover{background-color:#c35037;}}.text{color:#fff;font-size:14px;margin-top:10px;text-align:center;}&Inner{}.level{transition:height 0.3s;position:absolute;left:0;bottom:0;width:100%;height:0;background-color:rgba(0,0,0,.35);}}"]),i=new Map([["mic",[o.createElement(a.Audio,null),o.createElement(a.AudioClose,null)]],["cam",[o.createElement(a.Video,null),o.createElement(a.VideoClose,null)]]]);new Map([["mic","Mic"],["cam","Cam"]]);t.default=e=>{var t;let{onClick:n=(()=>{}),label:a=!0,disabled:r=!1,volumeLevel:c=0,type:s="mic"}=e;return o.createElement(l,null,o.createElement("button",{onClick:n,className:"button"},o.createElement("div",{className:"buttonInner"},o.createElement("div",{className:"buttonIcon"},null===(t=i.get(s))||void 0===t?void 0:t[r?1:0],o.createElement("span",{style:{height:100*c+"px"},className:"level"})),a&&o.createElement("div",{className:"text"},s.replace(s[0],s[0].toUpperCase())))))}},7112:function(e,t,n){n.r(t);var a=n(7294),o=n(3494),l=n(77),i=n(9390);const r=o.default.div.withConfig({displayName:"Buttons__StyledWrap",componentId:"sc-t5bzkq-0"})([".buttonMain{}.button{border:none;background:none;cursor:pointer;&:disabled{opacity:0.3;}&Icon{width:48px;height:48px;background-color:#f26b4d;border-radius:12px;display:flex;align-items:center;justify-content:center;&:hover{background-color:#c35037;}}.text{color:#fff;font-size:14px;margin-top:10px;text-align:center;}&Inner{}}"]);t.default=()=>{const{state:e,dispatch:t}=(0,a.useContext)(l.VoiceContext)||{},{localVideoTrack:n,localAudioTrack:o,videoEnabled:c,audioEnabled:s,joinState:d}=e||{},u=function(e){void 0===e&&(e="video");const n="video"===e?c:s;t({type:l.UPDATE_DEVICES_ENABLED,payload:{devices:e,enabled:!n}})};return(0,a.useEffect)((()=>{null==n||n.setMuted(!c)}),[c]),(0,a.useEffect)((()=>{null==o||o.setMuted(!s)}),[s]),a.createElement(r,null,a.createElement("button",{onClick:()=>u(),className:"button"},a.createElement("div",{className:"buttonInner"},a.createElement("div",{className:"buttonIcon"},c?a.createElement(i.Video,null):a.createElement(i.VideoClose,null)),a.createElement("div",{className:"text"},"Cam"))),a.createElement("button",{onClick:()=>u("audio"),className:"button"},a.createElement("div",{className:"buttonInner"},a.createElement("div",{className:"buttonIcon"},s?a.createElement(i.Audio,null):a.createElement(i.AudioClose,null)),a.createElement("div",{className:"text"},"Mic"))),a.createElement("button",{disabled:!d,onClick:()=>{t({type:l.LEAVE})},className:"button"},a.createElement("div",{className:"buttonInner"},a.createElement("div",{className:"buttonIcon"},a.createElement(i.Exit,null)),a.createElement("div",{className:"text"},"Leave"))))}},8278:function(e,t,n){n.r(t);var a=n(7294),o=n(8599),l=n(7112);t.default=()=>a.createElement(o.default,null,a.createElement(l.default,null))},8599:function(e,t,n){n.r(t);const a=n(3494).default.footer.withConfig({displayName:"styles__StyledWrapper",componentId:"sc-19oqb2v-0"})(["display:flex;align-items:center;justify-content:center;margin-bottom:10px;"]);t.default=a},1367:function(e,t,n){n.r(t);var a=n(7294),o=n(9965),l=n(881),i=n(77);t.default=()=>{const{state:e={}}=(0,a.useContext)(i.VoiceContext),{localVideoTrack:t,users:n,currentUser:r,extUsers:c}=e;return a.createElement(o.default,null,a.createElement("ul",{className:"users "+((null==n?void 0:n.length)>1?"usersMore":"")},a.createElement("li",{className:"user"},a.createElement(l.default,{videoTrack:t,audioTrack:void 0}),(null==t?void 0:t.muted)&&a.createElement("div",{className:"info"},null!=r&&r.photo?a.createElement("div",{className:"avatar"},a.createElement("img",{src:null==r?void 0:r.photo,className:"pic",alt:""})):a.createElement("div",{className:"name"},null==r?void 0:r.username))),null==n?void 0:n.map((e=>{var t,n,o;return a.createElement("li",{key:e.uid,className:"user"},a.createElement(l.default,{videoTrack:e.videoTrack,audioTrack:e.audioTrack}),!e.hasVideo&&a.createElement("div",{className:"info"},null!==(t=c.find((t=>t.intUid===e.uid)))&&void 0!==t&&t.photo?a.createElement("div",{className:"avatar"},a.createElement("img",{src:null===(n=c.find((t=>t.intUid===e.uid)))||void 0===n?void 0:n.photo,className:"pic",alt:""})):a.createElement("div",{className:"name"},null===(o=c.find((t=>t.intUid===e.uid)))||void 0===o?void 0:o.username)))}))))}},9965:function(e,t,n){n.r(t);const a=n(3494).default.div.withConfig({displayName:"styles__StyledWrapper",componentId:"sc-12nkcj5-0"})(["display:flex;height:100%;align-items:center;justify-content:center;.users{display:flex;flex-wrap:wrap;justify-content:center;align-items:center;gap:10px;margin-bottom:0;width:100%;&More{.player{width:320px;height:240px;}}}.user{position:relative;}.info{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);}.avatar{width:160px;height:160px;background-color:#333;overflow:hidden;.pic{width:100%;height:100%;}}.name{color:#fff;text-align:center;font-size:24px;}"]);t.default=a},8570:function(e,t,n){n.r(t);const a=n(3494).default.section.withConfig({displayName:"styles__StyledWrapper",componentId:"sc-jyr8gf-0"})(["display:flex;width:100%;height:100vh;flex-direction:column;justify-content:space-between;background-color:#19181D;.header{display:flex;align-items:center;padding:15px;justify-content:center;.title{color:#056CF2;font-style:normal;font-weight:800;font-size:36px;line-height:139.8%;background-size:contain;background-repeat:no-repeat;margin-bottom:0;}.logo{width:203px;height:36px;vertical-align:middle;}.sub_title{display:none;color:#606368;font-weight:normal;font-size:24px;line-height:139.8%;margin-bottom:0;margin-left:10px;}}.joinWrap{position:absolute;z-index:1;width:100vw;height:100vh;background-color:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;color:#fff;.button{display:flex;align-items:center;cursor:pointer;border:none;background-color:#f26b4d;padding:4px 20px;border-radius:12px;gap:10px;font-size:16px;&:hover{background-color:#c35037;}}.inner{}}"]);t.default=a},1720:function(e,t,n){t.Z=n.p+"static/logo-3b78150b3a1e9627ff334233aae997b5.png"}}]);
//# sourceMappingURL=84115711fa093525fd12098b28d0be3eb89b05a3-9e55a31681dd310d60dc.js.map