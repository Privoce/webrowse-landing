"use strict";(self.webpackChunkwebrowse_landing=self.webpackChunkwebrowse_landing||[]).push([[1514,3615,3754,299],{9417:function(e,t,n){n.r(t),n.d(t,{default:function(){return g}});var r=n(8634),a=n(2656),o=n.n(a),i=n(7294),c=n(6963),u=n.n(c),s="733ebd8906c84f8baafcbf548dcfe7da";var l,d=n(6660),f=n(489),p=n(9881),m=n(9287),v=n(3003),h=null===u()||void 0===u()||null===(l=u().createClient)||void 0===l?void 0:l.call(u(),{codec:"h264",mode:"rtc"}),g=function(){var e=(0,i.useContext)(m.VoiceContext),t=e.dispatch,n=e.state,a=n||{},c=a.status,l=a.cameraId,g=a.microphoneId,x=a.currentUser,E=new URLSearchParams("undefined"!=typeof window?window.location.search:""),b=(null==x?void 0:x.intUid)||function(){for(var e="123456789",t=e.length,n=[],r=0;r<9;r++)n[r]=e.charAt(Math.random()*t);return+n.join("")}()||+E.get("uid")||1,w=E.get("cid")||"test",y=function(e){var t=(0,i.useState)(void 0),n=t[0],a=t[1],c=(0,i.useState)(void 0),l=c[0],d=c[1],f=(0,i.useState)([]),p=f[0],m=f[1],v=(0,i.useState)(""),h=v[0],g=v[1],x=(0,i.useState)(null),E=x[0],b=x[1],w=(0,i.useState)(!1),y=w[0],k=w[1],T=(0,i.useState)([]),N=T[0],A=T[1],_=(0,i.useState)([]),C=_[0],U=_[1],S=function(){var e=(0,r.Z)(o().mark((function e(t,n){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://wechat.okeydemo.com/api/agora/get_token?uid="+t+"&channel="+n);case 2:return r=e.sent,e.next=5,r.text();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();function I(e,t){return j.apply(this,arguments)}function j(){return(j=(0,r.Z)(o().mark((function e(t,n){var r,i,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u().createMicrophoneAndCameraTracks(t,n);case 2:return r=e.sent,i=r[0],c=r[1],d(i),a(c),e.abrupt("return",[i,c]);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(0,i.useEffect)((function(){e&&(0,r.Z)(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u().getDevices();case 2:t=e.sent,m(t);case 4:case"end":return e.stop()}}),e)})))()}),[e]);var D=(0,i.useCallback)(function(){var t=(0,r.Z)(o().mark((function t(n,r,a,i){var c,u,l,d;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e&&r){t.next=2;break}return t.abrupt("return");case 2:return e.enableAudioVolumeIndicator(),b(r),g(n),t.next=7,S(r,n);case 7:return c=t.sent,t.next=10,I(a,i);case 10:return u=t.sent,l=u[0],d=u[1],t.next=15,e.join(s,n,c||null,+r);case 15:return t.next=17,e.publish([l,d]);case 17:window.client=e,window.videoTrack=d,k(!0);case 20:case"end":return t.stop()}}),t)})));return function(e,n,r,a){return t.apply(this,arguments)}}(),[]);function V(){return(V=(0,r.Z)(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l&&(l.stop(),l.close()),n&&(n.stop(),n.close()),A([]),k(!1),t.next=6,null==e?void 0:e.leave();case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return(0,i.useEffect)((function(){if(e){A(e.remoteUsers);var t=function(){var t=(0,r.Z)(o().mark((function t(n,r){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.subscribe(n,r);case 2:A((function(t){return Array.from(e.remoteUsers)}));case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),n=function(t){A((function(t){return Array.from(e.remoteUsers)}))},a=function(t){A((function(t){return Array.from(e.remoteUsers)}))},i=function(t){A((function(t){return Array.from(e.remoteUsers)}))};return e.on("user-published",t),e.on("user-unpublished",n),e.on("user-joined",a),e.on("user-left",i),function(){e.off("user-published",t),e.off("user-unpublished",n),e.off("user-joined",a),e.off("user-left",i)}}}),[e]),(0,i.useEffect)((function(){if(e&&h&&E){var t=function(){var t=(0,r.Z)(o().mark((function t(){var n;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("WillExpire"),t.next=3,S(E,h);case 3:return n=t.sent,t.next=6,e.renewToken(n);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),n=function(){var t=(0,r.Z)(o().mark((function t(){var n;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("Fetching the new Token"),t.next=3,S(E,h);case 3:return n=t.sent,console.log("Rejoining the channel with new Token"),t.next=7,e.join(s,h,n,E);case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),a=function(e){U(e),e.forEach((function(e,t){console.log(t+" UID "+e.uid+" Level "+e.level)}))};return e.on("token-privilege-will-expire",t),e.on("token-privilege-did-expire",n),e.on("volume-indicator",a),function(){e.off("token-privilege-will-expire",t),e.off("token-privilege-did-expire",n),e.off("volume-indicator",a)}}}),[e,h,E]),{localAudioTrack:l,localVideoTrack:n,joinState:y,leave:function(){return V.apply(this,arguments)},join:D,remoteUsers:N,devices:p,volumes:C}}(h),k=y.localAudioTrack,T=y.localVideoTrack,N=y.join,A=y.joinState,_=y.remoteUsers;(0,i.useEffect)((function(){t({type:m.UPDATE_CLIENT,payload:h})}),[]),(0,i.useEffect)((function(){}),[b,w]),(0,i.useEffect)((function(){T&&k&&(t({type:m.UPDATE_LOCAL_VIDEO_TRACK,payload:T}),t({type:m.UPDATE_LOCAL_AUDIO_TRACK,payload:k}))}),[T,k]),(0,i.useEffect)((function(){t({type:m.UPDATE_JOIN_STATE,payload:A})}),[A]),(0,i.useEffect)((function(){var e,t={source:"webrow.se/voice",payload:{status:null==n?void 0:n.status},event:"connect"};null===(e=window)||void 0===e||e.postMessage(t,"*")}),[null==n?void 0:n.status]),(0,i.useEffect)((function(){(0,r.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("will-join"!==(null==n?void 0:n.status)){e.next=3;break}return e.next=3,C({microphoneId:g},{cameraId:l});case 3:case"end":return e.stop()}}),e)})))()}),[null==n?void 0:n.status,l,g]),(0,i.useEffect)((function(){var e;t({type:m.UPDATE_USERS,payload:_});var n={source:"webrow.se/voice",payload:{remoteUsers:_.map((function(e){return{uid:e.uid}}))},event:"remote_users"};null===(e=window)||void 0===e||e.postMessage(n,"*")}),[_]);var C=function(){var e=(0,r.Z)(o().mark((function e(n,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:m.UPDATE_STATUS,payload:"connecting"}),e.next=3,N(w,b,n,r);case 3:t({type:m.UPDATE_JOIN_STATE,payload:!0}),t({type:m.UPDATE_STATUS,payload:"connected"});case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return i.createElement(f.default,null,i.createElement("header",{className:"header"},i.createElement("h1",{className:"title"},"Webrowse"),i.createElement("h2",{className:"sub_title"},"Sync tabs with your teammates!")),null!=n&&n.joinState?i.createElement(i.Fragment,null,i.createElement(p.default,null),i.createElement(d.default,null)):i.createElement("div",{className:"joinWrap"},i.createElement("button",{disabled:"connecting"===c,className:"button",onClick:function(){return C({microphoneId:g},{cameraId:l})}},i.createElement("div",{className:"inner"},i.createElement(v.JoinRoom,null)),"connecting"===c?"connecting":"Join")))}},2184:function(e,t,n){n.r(t);var r=n(7294),a=n(9),o=n(9287),i=n(3003),c=a.default.div.withConfig({displayName:"Buttons__StyledWrap",componentId:"sc-t5bzkq-0"})([".buttonMain{}.button{border:none;background:none;cursor:pointer;&:disabled{opacity:0.3;}&Icon{width:48px;height:48px;background-color:#f26b4d;border-radius:12px;display:flex;align-items:center;justify-content:center;&:hover{background-color:#c35037;}}.text{color:#fff;font-size:14px;margin-top:10px;text-align:center;}&Inner{}}"]);t.default=function(){var e=(0,r.useContext)(o.VoiceContext)||{},t=e.state,n=e.dispatch,a=t||{},u=a.localVideoTrack,s=a.localAudioTrack,l=a.videoEnabled,d=a.audioEnabled,f=a.joinState,p=function(e){void 0===e&&(e="video");var t="video"===e?l:d;n({type:o.UPDATE_DEVICES_ENABLED,payload:{devices:e,enabled:!t}})};return(0,r.useEffect)((function(){null==u||u.setMuted(!l)}),[l]),(0,r.useEffect)((function(){null==s||s.setMuted(!d)}),[d]),r.createElement(c,null,r.createElement("button",{onClick:function(){return p()},className:"button"},r.createElement("div",{className:"buttonInner"},r.createElement("div",{className:"buttonIcon"},l?r.createElement(i.Video,null):r.createElement(i.VideoClose,null)),r.createElement("div",{className:"text"},"Cam"))),r.createElement("button",{onClick:function(){return p("audio")},className:"button"},r.createElement("div",{className:"buttonInner"},r.createElement("div",{className:"buttonIcon"},d?r.createElement(i.Audio,null):r.createElement(i.AudioClose,null)),r.createElement("div",{className:"text"},"Mic"))),r.createElement("button",{disabled:!f,onClick:function(){n({type:o.LEAVE})},className:"button"},r.createElement("div",{className:"buttonInner"},r.createElement("div",{className:"buttonIcon"},r.createElement(i.Exit,null)),r.createElement("div",{className:"text"},"Leave"))))}},6660:function(e,t,n){n.r(t);var r=n(7294),a=n(363),o=n(2184);t.default=function(){return r.createElement(a.default,null,r.createElement(o.default,null))}},363:function(e,t,n){n.r(t);var r=n(9).default.footer.withConfig({displayName:"styles__StyledWrapper",componentId:"sc-19oqb2v-0"})(["display:flex;align-items:center;justify-content:center;margin-bottom:10px;"]);t.default=r},9881:function(e,t,n){n.r(t);var r=n(7294),a=n(1527),o=n(5728),i=n(9287);t.default=function(){var e=(0,r.useContext)(i.VoiceContext).state,t=void 0===e?{}:e,n=t.localVideoTrack,c=t.users,u=t.currentUser,s=t.extUsers;return r.createElement(a.default,null,r.createElement("ul",{className:"users "+((null==c?void 0:c.length)>1?"usersMore":"")},r.createElement("li",{className:"user"},r.createElement(o.default,{videoTrack:n,audioTrack:void 0}),r.createElement("div",{className:"info"},r.createElement("div",{className:"avatar"},r.createElement("img",{src:null==u?void 0:u.photo,className:"pic",alt:""})))),null==c?void 0:c.map((function(e){var t;return r.createElement("li",{key:e.uid,className:"user"},r.createElement(o.default,{videoTrack:e.videoTrack,audioTrack:e.audioTrack}),r.createElement("div",{className:"info"},r.createElement("div",{className:"avatar"},r.createElement("img",{src:null===(t=s.find((function(t){return t.intUid===e.uid})))||void 0===t?void 0:t.photo,className:"pic",alt:""}))))}))))}},1527:function(e,t,n){n.r(t);var r=n(9).default.div.withConfig({displayName:"styles__StyledWrapper",componentId:"sc-12nkcj5-0"})(["display:flex;height:100%;align-items:center;justify-content:center;.users{display:flex;flex-wrap:wrap;justify-content:center;align-items:center;gap:10px;margin-bottom:0;width:100%;&More{.player{width:320px;height:240px;}}}.user{position:relative;}.info{position:absolute;bottom:0;right:0;}.avatar{width:80px;height:80px;background-color:#333;opacity:0.75;overflow:hidden;.pic{width:100%;height:100%;}}.name{color:#fff;margin-top:4px;text-align:center;font-size:14px;}"]);t.default=r},489:function(e,t,n){n.r(t);var r=n(9).default.section.withConfig({displayName:"styles__StyledWrapper",componentId:"sc-jyr8gf-0"})(["display:flex;width:100%;height:100vh;flex-direction:column;justify-content:space-between;background-color:#19181D;.header{display:flex;align-items:center;padding:15px;justify-content:center;.title{color:#056CF2;font-style:normal;font-weight:800;font-size:36px;line-height:139.8%;padding-left:60px;background-image:url('https://static.nicegoodthings.com/project/ext/webrowse.logo.v2.png');background-size:contain;background-repeat:no-repeat;margin-bottom:0;}.sub_title{display:none;color:#606368;font-weight:normal;font-size:24px;line-height:139.8%;margin-bottom:0;margin-left:10px;}}.joinWrap{position:absolute;z-index:1;width:100vw;height:100vh;background-color:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;color:#fff;.button{display:flex;align-items:center;cursor:pointer;border:none;background-color:#f26b4d;padding:4px 20px;border-radius:12px;gap:10px;font-size:16px;&:hover{background-color:#c35037;}}.inner{}}"]);t.default=r}}]);
//# sourceMappingURL=ac64565eb20c37e8901c94db4ec8452985ca5493-78e1f29cea18cf9ff406.js.map