{"version":3,"file":"component---src-pages-voice-reducer-js-dc3577561bae1d31b0b0.js","mappings":"+sBAcMA,EAAY,CAChBC,MAAO,GACPC,WAAW,EACXC,gBAAiB,KACjBC,gBAAiB,KACjBC,OAAQ,KACRC,OAAQ,eACRC,QAAS,GACTC,qBAAiBC,EACjBC,cAAc,EACdC,cAAc,EACdC,cAAUH,EACVI,kBAAcJ,EACdK,YAAa,GACbC,SAAU,IAGNC,EAAe,eACfC,EAA2B,2BAC3BC,EAA2B,2BAC3BC,EAAoB,oBACpBC,EAAQ,QACRC,EAAgB,gBAChBC,EAAgB,gBAChBC,EAA0B,0BAC1BC,EAAiB,iBACjBC,EAAyB,yBACzBC,EAAoB,oBACpBC,EAAqB,qBACrBC,EAAmB,mBAEnBC,EAAU,SAACC,EAAOC,GAAY,IAAD,IA2B7B,EA1BI3B,EAA6C0B,EAA7C1B,gBAAiBD,EAA4B2B,EAA5B3B,gBAAiBE,EAAWyB,EAAXzB,OAC1C,OAAQ0B,EAAOC,MACb,KAAKhB,EACH,OAAO,OAAP,UACKc,EADL,CAEE7B,MAAO8B,EAAOE,UAGlB,KAAKhB,EACH,OAAO,OAAP,UACKa,EADL,CAEE3B,gBAAiB4B,EAAOE,UAE5B,KAAKf,EACH,OAAO,OAAP,UACKY,EADL,CAEE1B,gBAAiB2B,EAAOE,UAG5B,KAAKd,EACH,OAAO,OAAP,UACKW,EADL,CAEE5B,UAAW6B,EAAOE,UAGtB,KAAKb,EAYH,OAXA,oBAAC,qFACKhB,IACFA,EAAgB8B,OAChB9B,EAAgB+B,SAEdhC,IACFA,EAAgB+B,OAChB/B,EAAgBgC,SAPnB,SASO9B,MAAAA,OATP,EASOA,EAAQ+B,QATf,2CAAD,8CAWO,OAAP,UACKN,EADL,CAEE7B,MAAO,GACPC,WAAW,EACXI,OAAQ,UAEZ,KAAKe,EACH,OAAO,OAAP,UACKS,EADL,CAEEzB,OAAQ0B,EAAOE,UAEnB,KAAKX,EACH,OAAO,OAAP,UACKQ,EADL,CAEExB,OAAQyB,EAAOE,UAGnB,KAAKV,EACH,OAAO,OAAP,UACKO,EADL,CAEEtB,gBAAiBuB,EAAOE,UAG5B,KAAKT,EACH,OAAO,OAAP,UACKM,EADL,CAEEvB,QAASwB,EAAOE,UAGpB,KAAKR,EACH,MAGIM,EAAOE,QAHX,IACE1B,QAAAA,OADF,MACY,GADZ,MAEE8B,QAAAA,OAFF,WAEY5B,EAFZ,EAKA,OAAO,OAAP,UACKqB,IADL,MAEMvB,EAFN,WAEyB8B,EAFzB,IAKF,KAAKX,EACH,MAGIK,EAAOE,QAHX,IACED,KAAAA,OADF,MACS,GADT,MAEEM,GAAAA,OAFF,WAEO7B,EAFP,EAKA,OAAO,OAAP,UACKqB,IADL,MAEME,EAFN,MAEiBM,EAFjB,IAKF,KAAKX,EACH,OAAO,OAAP,UACKG,EADL,CAEEhB,YAAaiB,EAAOE,UAGxB,KAAKL,EACH,OAAO,OAAP,UACKE,EADL,CAEEf,SAAUgB,EAAOE,UAErB,QACE,OAAOH,IAIPS,GAAeC,EAAAA,EAAAA,eAAcxC,GASnC,UAPwB,SAAAyC,GACtB,OAA0BC,EAAAA,EAAAA,YAAWb,EAAS7B,GAAW,SAAA2C,GAAG,OAAIA,KAAzDb,EAAP,KAAcc,EAAd,KACA,OAAQ,gBAACL,EAAaM,SAAd,CAAuBC,MAAO,CAAEhB,MAAAA,EAAOc,SAAAA,IAC5CH,EAAMM","sources":["webpack://webrowse-landing/./src/pages/voice/reducer.js"],"sourcesContent":["/**\n * @author: laoona\n * @date:  2022-03-18\n * @time: 17:37\n * @contact: laoona.com\n * @description: #\n */\n\nimport React, { createContext, useReducer } from \"react\"\n\n/**\n * status enums ['disconnected', 'will-join', 'connecting', 'connected', 'leave']\n * @type {{localAudioTrack: null, localVideoTrack: null, joinState: boolean, client: null, users: *[], status: string}}\n */\nconst initValue = {\n  users: [],\n  joinState: false,\n  localVideoTrack: null,\n  localAudioTrack: null,\n  client: null,\n  status: \"disconnected\",\n  devices: [],\n  permissionState: undefined, // enums ['dismissed', 'denied', 'allow', 'complete']\n  videoEnabled: true,\n  audioEnabled: true,\n  cameraId: undefined,\n  microphoneId: undefined,\n  currentUser: {}, // 当前扩展登录的用户\n  extUsers: [], // 当前扩展 Webrowse 用户列表\n}\n\nconst UPDATE_USERS = \"UPDATE_USERS\"\nconst UPDATE_LOCAL_VIDEO_TRACK = \"UPDATE_LOCAL_VIDEO_TRACK\"\nconst UPDATE_LOCAL_AUDIO_TRACK = \"UPDATE_LOCAL_AUDIO_TRACK\"\nconst UPDATE_JOIN_STATE = \"UPDATE_JOIN_STATE\"\nconst LEAVE = \"LEAVE\"\nconst UPDATE_CLIENT = \"UPDATE_CLIENT\"\nconst UPDATE_STATUS = \"UPDATE_STATUS\"\nconst UPDATE_PERMISSION_STATE = \"UPDATE_PERMISSION_STATE\"\nconst UPDATE_DEVICES = \"UPDATE_DEVICES\"\nconst UPDATE_DEVICES_ENABLED = \"UPDATE_DEVICES_ENABLED\"\nconst UPDATE_DEVICES_ID = \"UPDATE_DEVICES_ID\"\nconst UPDATE_CURRENT_USR = \"UPDATE_CURRENT_USR\"\nconst UPDATE_EXT_USERS = \"UPDATE_EXT_USERS\"\n\nconst reducer = (state, action) => {\n  const { localAudioTrack, localVideoTrack, client } = state\n  switch (action.type) {\n    case UPDATE_USERS:\n      return {\n        ...state,\n        users: action.payload,\n      }\n\n    case UPDATE_LOCAL_VIDEO_TRACK:\n      return {\n        ...state,\n        localVideoTrack: action.payload,\n      }\n    case UPDATE_LOCAL_AUDIO_TRACK:\n      return {\n        ...state,\n        localAudioTrack: action.payload,\n      }\n\n    case UPDATE_JOIN_STATE:\n      return {\n        ...state,\n        joinState: action.payload,\n      }\n\n    case LEAVE:\n      (async function leave() {\n        if (localAudioTrack) {\n          localAudioTrack.stop()\n          localAudioTrack.close()\n        }\n        if (localVideoTrack) {\n          localVideoTrack.stop()\n          localVideoTrack.close()\n        }\n        await client?.leave()\n      })()\n      return {\n        ...state,\n        users: [],\n        joinState: false,\n        status: \"leave\",\n      }\n    case UPDATE_CLIENT:\n      return {\n        ...state,\n        client: action.payload,\n      }\n    case UPDATE_STATUS:\n      return {\n        ...state,\n        status: action.payload,\n      }\n\n    case UPDATE_PERMISSION_STATE:\n      return {\n        ...state,\n        permissionState: action.payload,\n      }\n\n    case UPDATE_DEVICES:\n      return {\n        ...state,\n        devices: action.payload,\n      }\n\n    case UPDATE_DEVICES_ENABLED:\n      const {\n        devices = '',\n        enabled = undefined,\n      } = action.payload;\n\n      return {\n        ...state,\n        [`${devices}Enabled`]: enabled,\n      }\n\n    case UPDATE_DEVICES_ID:\n      const {\n        type = '',\n        id = undefined,\n      } = action.payload;\n\n      return {\n        ...state,\n        [`${type}Id`]: id,\n      }\n\n    case UPDATE_CURRENT_USR:\n      return {\n        ...state,\n        currentUser: action.payload,\n      }\n\n    case UPDATE_EXT_USERS:\n      return {\n        ...state,\n        extUsers: action.payload,\n      }\n    default:\n      return state\n  }\n}\n\nconst VoiceContext = createContext(initValue)\n\nconst ContextProvider = props => {\n  const [state, dispatch] = useReducer(reducer, initValue, val => val)\n  return (<VoiceContext.Provider value={{ state, dispatch }}>\n    {props.children}\n  </VoiceContext.Provider>)\n}\n\nexport default ContextProvider\n\nexport {\n  VoiceContext,\n  UPDATE_USERS,\n\n  UPDATE_LOCAL_VIDEO_TRACK,\n  UPDATE_LOCAL_AUDIO_TRACK,\n  UPDATE_JOIN_STATE,\n  LEAVE,\n  UPDATE_CLIENT,\n  UPDATE_STATUS,\n  UPDATE_PERMISSION_STATE,\n  UPDATE_DEVICES,\n  UPDATE_DEVICES_ENABLED,\n  UPDATE_DEVICES_ID,\n  UPDATE_CURRENT_USR,\n  UPDATE_EXT_USERS,\n}\n\n"],"names":["initValue","users","joinState","localVideoTrack","localAudioTrack","client","status","devices","permissionState","undefined","videoEnabled","audioEnabled","cameraId","microphoneId","currentUser","extUsers","UPDATE_USERS","UPDATE_LOCAL_VIDEO_TRACK","UPDATE_LOCAL_AUDIO_TRACK","UPDATE_JOIN_STATE","LEAVE","UPDATE_CLIENT","UPDATE_STATUS","UPDATE_PERMISSION_STATE","UPDATE_DEVICES","UPDATE_DEVICES_ENABLED","UPDATE_DEVICES_ID","UPDATE_CURRENT_USR","UPDATE_EXT_USERS","reducer","state","action","type","payload","stop","close","leave","enabled","id","VoiceContext","createContext","props","useReducer","val","dispatch","Provider","value","children"],"sourceRoot":""}