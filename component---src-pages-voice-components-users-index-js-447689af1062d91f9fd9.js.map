{"version":3,"file":"component---src-pages-voice-components-users-index-js-447689af1062d91f9fd9.js","mappings":"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","sources":["webpack://webrowse-landing/./src/pages/voice/components/MediaPlayer/index.js","webpack://webrowse-landing/./src/pages/voice/components/MediaPlayer/styles.js","webpack://webrowse-landing/./src/pages/voice/components/Users/index.js","webpack://webrowse-landing/./src/pages/voice/components/Users/styles.js","webpack://webrowse-landing/./src/pages/voice/reducer.js"],"sourcesContent":["/**\n * @author: laoona\n * @date:  2022-03-01\n * @time: 14:52\n * @contact: laoona.com\n * @description: #\n */\n\nimport React, { useRef, useEffect } from \"react\"\nimport StyledWrapper from \"./styles\"\n\nconst Index = (props) => {\n  const container = useRef(null)\n  useEffect(() => {\n    if (!container.current) return\n    props.videoTrack?.play(container.current)\n    return () => {\n      props.videoTrack?.stop()\n    }\n  }, [container, props.videoTrack])\n\n  useEffect(() => {\n    if (props.audioTrack) {\n      props.audioTrack?.play()\n    }\n    return () => {\n      props.audioTrack?.stop()\n    }\n  }, [props.audioTrack])\n\n  return (\n    <StyledWrapper>\n      <div ref={container} className=\"player\" />\n    </StyledWrapper>\n  )\n}\n\nexport default Index\n","/**\n * @author: laoona\n * @date:  2022-03-18\n * @time: 22:24\n * @contact: laoona.com\n * @description: #\n */\n\nimport styled from \"styled-components\";\n\nconst StyledWrapper = styled.div`\n  .player {\n    width: 640px;\n    height: 480px;\n    background-color: #000;\n  }\n`;\n\nexport default StyledWrapper;\n","/**\n * @author: laoona\n * @date:  2022-03-18\n * @time: 17:02\n * @contact: laoona.com\n * @description: #\n */\n\nimport React, { useContext } from \"react\"\nimport StyledWrapper from \"./styles\"\nimport MediaPlayer from \"../MediaPlayer\"\nimport { VoiceContext } from \"../../reducer\"\n\nconst Users = () => {\n  const { state = {} } = useContext(VoiceContext)\n  const { localVideoTrack, users, currentUser, extUsers } = state\n\n  return <StyledWrapper>\n    <ul className={`users ${users?.length > 1 ? \"usersMore\" : \"\"}`}>\n      <li className=\"user\">\n        <MediaPlayer videoTrack={localVideoTrack} audioTrack={undefined} />\n        {\n          localVideoTrack?.muted &&\n          <div className=\"info\">\n            {\n              currentUser?.photo ?\n                <div className=\"avatar\"><img src={currentUser?.photo} className=\"pic\" alt=\"\" /></div>\n                :\n                <div className=\"name\">{currentUser?.username}</div>\n            }\n          </div>\n        }\n      </li>\n      {\n        users?.map(user =>\n          <li key={user.uid} className=\"user\">\n            <MediaPlayer videoTrack={user.videoTrack} audioTrack={user.audioTrack} />\n            {!(user.hasVideo) &&\n              <div className=\"info\">\n                {\n                  extUsers.find(item => item.intUid === user.uid)?.photo ?\n                    <div className=\"avatar\">\n                      <img\n                        src={extUsers.find(item => item.intUid === user.uid)?.photo}\n                        className=\"pic\" alt=\"\" />\n                    </div>\n                    :\n                    <div className=\"name\">{extUsers.find(item => item.intUid === user.uid)?.username}</div>\n                }\n              </div>\n            }\n          </li>\n        )\n      }\n    </ul>\n  </StyledWrapper>\n}\n\nexport default Users\n","/**\n * @author: laoona\n * @date:  2022-03-18\n * @time: 17:02\n * @contact: laoona.com\n * @description: #\n */\n\nimport styled from 'styled-components';\n\nconst StyledWrapper = styled.div`\n  display: flex;\n  height: 100%;\n  align-items: center;\n  justify-content: center;\n  .users {\n    display: flex;\n    flex-wrap: wrap;\n    justify-content: center;\n    align-items: center;\n    gap: 10px;\n    margin-bottom: 0;\n    width: 100%;\n    &More {\n      .player {\n        width: 320px;\n        height: 240px;\n      } \n    }\n  }\n  .user {\n    position: relative;\n  }\n  .info {\n    position: absolute; \n    left: 50%;\n    top: 50%;\n    transform: translate(-50%, -50%);\n  }\n  .avatar {\n    width: 160px;\n    height: 160px;\n    background-color: #333;\n    //border-radius: 8px;\n    overflow: hidden;\n    .pic {\n      width: 100%;\n      height: 100%;\n    }\n  }\n  .name {\n    color: #fff;\n    text-align: center;\n    font-size: 24px;\n  }\n  `;\n\nexport default StyledWrapper;\n","/**\n * @author: laoona\n * @date:  2022-03-18\n * @time: 17:37\n * @contact: laoona.com\n * @description: #\n */\n\nimport React, { createContext, useReducer } from \"react\"\n\n/**\n * status enums ['disconnected', 'will-join', 'connecting', 'connected', 'leave']\n * @type {{localAudioTrack: null, localVideoTrack: null, joinState: boolean, client: null, users: *[], status: string}}\n */\nconst initValue = {\n  users: [],\n  joinState: false,\n  localVideoTrack: null,\n  localAudioTrack: null,\n  client: null,\n  status: \"disconnected\",\n  devices: [],\n  permissionState: undefined, // enums ['dismissed', 'denied', 'allow', 'complete']\n  videoEnabled: true,\n  audioEnabled: true,\n  cameraId: undefined,\n  microphoneId: undefined,\n  currentUser: {}, // 当前扩展登录的用户\n  extUsers: [], // 当前扩展 Webrowse 用户列表\n}\n\nconst UPDATE_USERS = \"UPDATE_USERS\"\nconst UPDATE_LOCAL_VIDEO_TRACK = \"UPDATE_LOCAL_VIDEO_TRACK\"\nconst UPDATE_LOCAL_AUDIO_TRACK = \"UPDATE_LOCAL_AUDIO_TRACK\"\nconst UPDATE_JOIN_STATE = \"UPDATE_JOIN_STATE\"\nconst LEAVE = \"LEAVE\"\nconst UPDATE_CLIENT = \"UPDATE_CLIENT\"\nconst UPDATE_STATUS = \"UPDATE_STATUS\"\nconst UPDATE_PERMISSION_STATE = \"UPDATE_PERMISSION_STATE\"\nconst UPDATE_DEVICES = \"UPDATE_DEVICES\"\nconst UPDATE_DEVICES_ENABLED = \"UPDATE_DEVICES_ENABLED\"\nconst UPDATE_DEVICES_ID = \"UPDATE_DEVICES_ID\"\nconst UPDATE_CURRENT_USR = \"UPDATE_CURRENT_USR\"\nconst UPDATE_EXT_USERS = \"UPDATE_EXT_USERS\"\n\nconst reducer = (state, action) => {\n  const { localAudioTrack, localVideoTrack, client } = state\n  switch (action.type) {\n    case UPDATE_USERS:\n      return {\n        ...state,\n        users: action.payload,\n      }\n\n    case UPDATE_LOCAL_VIDEO_TRACK:\n      return {\n        ...state,\n        localVideoTrack: action.payload,\n      }\n    case UPDATE_LOCAL_AUDIO_TRACK:\n      return {\n        ...state,\n        localAudioTrack: action.payload,\n      }\n\n    case UPDATE_JOIN_STATE:\n      return {\n        ...state,\n        joinState: action.payload,\n      }\n\n    case LEAVE:\n      (async function leave() {\n        if (localAudioTrack) {\n          localAudioTrack.stop()\n          localAudioTrack.close()\n        }\n        if (localVideoTrack) {\n          localVideoTrack.stop()\n          localVideoTrack.close()\n        }\n        await client?.leave()\n      })()\n      return {\n        ...state,\n        users: [],\n        joinState: false,\n        status: \"leave\",\n      }\n    case UPDATE_CLIENT:\n      return {\n        ...state,\n        client: action.payload,\n      }\n    case UPDATE_STATUS:\n      return {\n        ...state,\n        status: action.payload,\n      }\n\n    case UPDATE_PERMISSION_STATE:\n      return {\n        ...state,\n        permissionState: action.payload,\n      }\n\n    case UPDATE_DEVICES:\n      return {\n        ...state,\n        devices: action.payload,\n      }\n\n    case UPDATE_DEVICES_ENABLED:\n      const {\n        devices = '',\n        enabled = undefined,\n      } = action.payload;\n\n      return {\n        ...state,\n        [`${devices}Enabled`]: enabled,\n      }\n\n    case UPDATE_DEVICES_ID:\n      const {\n        type = '',\n        id = undefined,\n      } = action.payload;\n\n      return {\n        ...state,\n        [`${type}Id`]: id,\n      }\n\n    case UPDATE_CURRENT_USR:\n      return {\n        ...state,\n        currentUser: action.payload,\n      }\n\n    case UPDATE_EXT_USERS:\n      return {\n        ...state,\n        extUsers: action.payload,\n      }\n    default:\n      return state\n  }\n}\n\nconst VoiceContext = createContext(initValue)\n\nconst ContextProvider = props => {\n  const [state, dispatch] = useReducer(reducer, initValue, val => val)\n  return (<VoiceContext.Provider value={{ state, dispatch }}>\n    {props.children}\n  </VoiceContext.Provider>)\n}\n\nexport default ContextProvider\n\nexport {\n  VoiceContext,\n  UPDATE_USERS,\n\n  UPDATE_LOCAL_VIDEO_TRACK,\n  UPDATE_LOCAL_AUDIO_TRACK,\n  UPDATE_JOIN_STATE,\n  LEAVE,\n  UPDATE_CLIENT,\n  UPDATE_STATUS,\n  UPDATE_PERMISSION_STATE,\n  UPDATE_DEVICES,\n  UPDATE_DEVICES_ENABLED,\n  UPDATE_DEVICES_ID,\n  UPDATE_CURRENT_USR,\n  UPDATE_EXT_USERS,\n}\n\n"],"names":["props","container","useRef","useEffect","_props$videoTrack","current","videoTrack","play","_props$videoTrack2","stop","_props$audioTrack","audioTrack","_props$audioTrack2","React","StyledWrapper","ref","className","styled","div","withConfig","displayName","componentId","Users","state","useContext","VoiceContext","localVideoTrack","users","currentUser","extUsers","length","MediaPlayer","undefined","muted","photo","src","alt","username","map","user","_extUsers$find","_extUsers$find2","_extUsers$find3","key","uid","hasVideo","find","item","intUid","initValue","joinState","localAudioTrack","client","status","devices","permissionState","videoEnabled","audioEnabled","cameraId","microphoneId","UPDATE_USERS","UPDATE_LOCAL_VIDEO_TRACK","UPDATE_LOCAL_AUDIO_TRACK","UPDATE_JOIN_STATE","LEAVE","UPDATE_CLIENT","UPDATE_STATUS","UPDATE_PERMISSION_STATE","UPDATE_DEVICES","UPDATE_DEVICES_ENABLED","UPDATE_DEVICES_ID","UPDATE_CURRENT_USR","UPDATE_EXT_USERS","reducer","action","type","payload","close","leave","enabled","id","createContext","dispatch","useReducer","val","Provider","value","children"],"sourceRoot":""}